[Data]
life = 1000
attack = 100
defence = 100
power = 3000
fall.defence_up = 50
liedown.time = 60
airjuggle = 15
sparkno = 2
guard.sparkno = 40
KO.echo = 0
IntPersistIndex = 60
FloatPersistIndex = 40

[Size]
xscale = 1
yscale = 1
ground.back = 30
ground.front = 31
air.back = 26
air.front = 24
height = 60
attack.dist = 160
proj.attack.dist = 90
proj.doscale = 0
head.pos = 4, -92
mid.pos = -2, -64
shadowoffset = 0
draw.offset = 0,0

[Velocity]
walk.fwd  = 2.4
walk.back = -2.2
run.fwd  = 9, 0
run.back = -9,-3.8
jump.neu = 0,-11
jump.back = -2.55
jump.fwd = 2.5
runjump.back = -6,-11
runjump.fwd = 6,-11
airjump.neu = 0,-11
airjump.back = -4
airjump.fwd = 4
air.gethit.groundrecover = -.15,-3.5
air.gethit.airrecover.mul = .5,.2
air.gethit.airrecover.add = 0,-4.5
air.gethit.airrecover.back = -1
air.gethit.airrecover.fwd = 0
air.gethit.airrecover.up = -2
air.gethit.airrecover.down = 1.5

[Movement]
airjump.num = 1
airjump.height = 35
yaccel = .65
stand.friction = .85
crouch.friction = .82
stand.friction.threshold = 2
crouch.friction.threshold = .05
air.gethit.groundlevel = 25
air.gethit.groundrecover.ground.threshold = -20
air.gethit.groundrecover.groundlevel = 12
air.gethit.airrecover.threshold = -1
air.gethit.airrecover.yaccel = .35
air.gethit.trip.groundlevel = 15
down.bounce.offset = 0, 20
down.bounce.yaccel = .4
down.bounce.groundlevel = 12
down.friction.threshold = .05

[Quotes]
victory1 = "That's right, you may have anticipated my attacks so far, but you have no idea what I am capable of now... and what you don't know... could hurt you."
victory2 = "You were alot easier than I thought, We should fight again!"
victory3 = "Im forced to say this before Genesis told me to say it"
;---------------------------------------------------------------------------
; Stand / Tired Stand
[Statedef 0]
type = S
physics = S
sprpriority = 0

[State 0, Standing animation / Tired animation]
Type = ChangeAnim
Trigger1 = Anim != IfElse (Life <= 200, 1, 0) && Anim != 5
Trigger2 = Anim = 5 && AnimTime = 0 ;Turn anim over
Value = IfElse (Life <= 200 , 1, 0)

[State 0, 2]
type = VelSet
trigger1 = Time = 0
y = 0

[State 0, 3] ;Stop moving if low velocity or 4 ticks pass
type = VelSet
trigger1 = abs(vel x) < Const(movement.stand.friction.threshold)
trigger2 = Time = 4
x = 0

[State 0, 4] ;Are you dead?
type = ChangeState
trigger1 = !alive
value = 5050
ctrl = 0
;---------------------------------------------------------------------------
; Dash
[Statedef 100]
type = S
physics = N
ctrl = 0
anim = 100
movetype = I
sprpriority = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nowalk

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,0
volumescale = 100
channel = -1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 3
x = 15
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = time > 10
x = .9

[State 1000, Explod]
type = Explod
trigger1 = time >0 && time <20
anim = 7050
ID = 7050
pos = 0,-70
random = 0,80
velocity = -5,0
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 1000, Explod]
type = Explod
trigger1 = time%3=0 && time >0
anim = 8100
ID = 8100
pos = 20,5
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = .5,.5
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 6
value = 1

[State 195, 2]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Dash Air
[Statedef 101]
type = A
physics = N
ctrl = 0
anim = 101
movetype = I
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,0
volumescale = 100
channel = -1

[State 1000, Explod]
type = Explod
trigger1 = time >0 && time <20
anim = 7050
ID = 7050
pos = 0,-65
random = 0,90
velocity = -5,0
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 15
y = -1

[State 0, VelMul]
type = VelMul
trigger1 = time > 10
x = .9

[State 0, Gravity]
type = Gravity
trigger1 = time > 10

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 6
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0 
value = 52

;---------------------------------------------------------------------------
; Dash Back
[Statedef 105]
type = S
physics = N
ctrl = 0
anim = 105
movetype = I
sprpriority = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nowalk

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,0
volumescale = 100
channel = -1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 2
x = -15
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = time > 8
x = .9

[State 1000, Explod]
type = Explod
trigger1 = time >0 && time <20
anim = 7050
ID = 7050
pos = 0,-70
random = 0,80
velocity = 5,0
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
ignorehitpause = 1
[State 1000, Explod]
type = Explod
trigger1 = time%3=0 && time >0
anim = 8100
ID = 8100
pos = 20,5
postype = p1
facing = -1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = .5,.5
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 6
value = 1

[State 195, 2]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Dash Back Air
[Statedef 106]
type = A
physics = N
ctrl = 0
anim = 106
movetype = I
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,0
volumescale = 100
channel = -1

[State 1000, Explod]
type = Explod
trigger1 = time >0 && time <20
anim = 7050
ID = 7050
pos = 0,-65
random = 0,90
velocity = 5,0
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = -15
y = -1

[State 0, VelMul]
type = VelMul
trigger1 = time > 8
x = .9

[State 0, Gravity]
type = Gravity
trigger1 = time > 10

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 6
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0 
value = 52

;---------------------------------------------------------------------------
; Lose by Time Over
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Win state decider
[Statedef 180]
type = S

[State 180, 1] ; THIS IS A "RE-DIRECTOR" CODE.
type = ChangeState
trigger1 = Time = 0
value = 181

;---------------------------------------------------------------------------
; Win pose 1
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s190, 1
channel = -1
volumescale = 100

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s180, 3
channel = 0
volumescale = 100

[State 0, Explod]
type = Explod
trigger1 = animelem = 3
anim = 182
ID = 8110
pos = 0,10
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = .5,1
sprpriority = 5
ownpal = 1
removeongethit = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 3
anim = 8110
ID = 8110
pos = 0,-5
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
removeongethit = 1
;---------------------------------------------------------------------------
; Introduction
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0

[State 191, 1]
type = ChangeAnim
trigger1 = RoundState = 0
value = 190

[State 191, 2]
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 0, AllPalFX]
type = PalFX
trigger1 = animelem = 21
time = 2
add = 255,255,255

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 21
time = 15
freq = 60
ampl = -4
phase = 90

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = S190,0
volumescale = 100
channel = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 21
value = S190,1
volumescale = 100
channel = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 10
anim = 8030
ID = 8030
pos = 5,35
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,1;gameheight/128
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 22
anim = 191
ID = 191
pos = 0,0
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 6
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 21
anim = 8110
ID = 8260
pos = 0,0
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, StopSnd]
type = StopSnd
trigger1 = roundstate = 2
channel = -1

[State 191, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; Taunt
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 2

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Stand Punch 1
[Statedef 200]
type    = S
movetype= A
physics = S
juggle  = 1
velset = 6,0
ctrl = 0
anim = 200
poweradd = 30
sprpriority = 2

[State 200, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-75
hitsound = s1, 0
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -4
air.velocity = -1.4,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 200, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "x" && movecontact
value = 230
ctrl = 0

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 380

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s7, 0+random%3
channel = 0
volumescale = 100

[State 200, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Crouch Punch 1
[Statedef 210]
type    = C
movetype= A
physics = C
juggle  = 1
velset = 0,0
ctrl = 0
anim = 210
poweradd = 25
sprpriority = 2

[State 205, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage = 23, 0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-73
hitsound = s1, 0
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -4
air.velocity = -1.4,-3
ground.hittime  = 11
air.hittime = 11
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 210, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "x" && movecontact && command = "holddown"
value = 215
ctrl = 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s7, 0+random%3
channel = 0
volumescale = 100

[State 210, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1
;---------------------------------------------------------------------------
; Crouch Punch 2
[Statedef 215]
type    = C
movetype= A
physics = C
juggle  = 1
velset = 10,0
ctrl = 0
anim = 230
poweradd = 25
sprpriority = 2

[State 205, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-73
hitsound = s1, 0
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -4
air.velocity = -1.4,-3
ground.hittime  = 11
air.hittime = 11
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 210, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 340

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 210, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1
;---------------------------------------------------------------------------
; Air Punch 1
[Statedef 220]
type    = A
movetype= A
physics = A
juggle  = 1
ctrl = 0
anim = 220
poweradd = 35
sprpriority = 2

[State 220, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 23, 0
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=60), var(17):=-40
hitsound = s1, 1
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -4
air.velocity = -1.4,5
ground.hittime  = 20
air.hittime = 11
airguard.velocity = -1.9,-.8
fall = ifelse(p2statetype = A, 1,0)
down.bounce = 1
down.velocity = -3,-10
;getpower = 0,0

[State 220, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "z" && movecontact
value = 440
ctrl = 0

;---------------------------------------------------------------------------
; Stand Punch 2
[Statedef 230]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 6,0
ctrl = 0
anim = 250
poweradd = 30
sprpriority = 2

[State 200, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-85
hitsound = s1, 1
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -7
air.velocity = -2,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 200, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "x" && movecontact
value = 240
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "y" && movecontact
value = 360
ctrl = 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s7, 0+random%3
channel = 0
volumescale = 100

[State 200, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Punch 3
[Statedef 240]
type    = A
movetype= A
physics = S
juggle  = 2
velset = 6,0
ctrl = 0
anim = 260
poweradd = 30
sprpriority = 2

[State 240, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-70
hitsound = s1, 1
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -7
air.velocity = -2,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 240, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 240, ChangeState]
type = ChangeState
trigger1 = command = "x" && movecontact
value = 250
ctrl = 0

[State 240, ChangeState]
type = ChangeState
trigger1 = command = "y" && movecontact
value = 370
ctrl = 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 240, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Punch 4
[Statedef 250]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 0,0
ctrl = 0
anim = 270
poweradd = 30
sprpriority = 2

[State 250, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 75, 5
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 20
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-55
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -5,-3
air.velocity = -1.4,-3
ground.hittime  = 30
air.hittime = 30
airguard.velocity = -1.9,-.8
fall = 1
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 0, Explod]
type = Explod
trigger1 = movehit = 1
anim = 8300
ID = 8300
pos = 0,0
postype = left
bindtime = -1
removetime = 20
pausemovetime = 99
supermovetime = 99
scale = gamewidth/640,gameheight/480
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1
persistent = 0

[State 250, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 240, ChangeState]
type = ChangeState
trigger1 = command = "x" && moveguarded
value = 290
ctrl = 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s6, 0+random%3
channel = 0
volumescale = 100

[State 250, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Punch 5
[Statedef 260]
type    = A
movetype= A
physics = N
juggle  = 2
ctrl = 0
anim = 240
poweradd = 30
sprpriority = 2

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = .95

[State 250, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 20
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-85
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -5,-3
air.velocity = -1.4,-3
ground.hittime  = 30
air.hittime = 30
airguard.velocity = -1.9,-.8
fall = 1
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 250, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 250, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Air Finisher
[Statedef 270]
type    = A
movetype= A
physics = N
juggle  = 1
ctrl = 0
anim = 280
velset = ifelse(prevstateno = 445,-2,-.5),ifelse(prevstateno = 445,1,-.5)
poweradd = 35
sprpriority = 2

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S350,0
volumescale = 100
channel = -1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 20
movetime = 20

[State 0, Explod]
type = Explod
trigger1 = !time || animelem = 5
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 5
x = enemy,pos x + ifelse(facing=1,80,-80)
y = ifelse(prevstateno = 445,enemy,pos y + 40,enemy,pos y - 60)

[State 0, Turn]
type = Turn
trigger1 = animelem = 6

[State 250, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 16
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-70
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -15,0
air.velocity = -15,20
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 1
fall.xvelocity = .1
fall.yvelocity = 0
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 250, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s6, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
triggerall = power >= 1000
trigger1 = movehit && command = "z" && hitshakeover=1
value = 1200

[State 0, Gravity]
type = Gravity
trigger1 = time > 44

[State 250, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0
value = 52
;---------------------------------------------------------------------------
; Air Finisher Alternate
[Statedef 271]
type    = A
movetype= A
physics = N
juggle  = 1
ctrl = 0
anim = 281
velset = -2,1
poweradd = 35
sprpriority = 2

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S350,0
volumescale = 100
channel = -1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 20
movetime = 20

[State 0, Explod]
type = Explod
trigger1 = !time || animelem = 5
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 5
x = enemy,pos x + ifelse(facing=1,80,-80)
y = ifelse(prevstateno = 445,enemy,pos y + 40,enemy,pos y - 60)

[State 0, Turn]
type = Turn
trigger1 = animelem = 6

[State 250, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 16
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-70
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -15,0
air.velocity = -15,20
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 1
fall.xvelocity = .1
fall.yvelocity = 0
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 250, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s6, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
triggerall = power >= 1000
trigger1 = movehit && command = "z" && hitshakeover=1
value = 1200

[State 0, Gravity]
type = Gravity
trigger1 = time > 37

[State 250, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0
value = 52
;---------------------------------------------------------------------------
; 1 Inch Punch
[Statedef 290]
type    = S
movetype= I
physics = S
juggle  = 3
velset = 0,0
ctrl = 0
anim = 290
sprpriority = 2

[State 0, HitOverride]
type = HitOverride
trigger1 = !time
attr = SCA,NA,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
stateno = 291
time = 38

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s290,0
channel = 0
volumescale = 100

[State 250, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; 1 Inch Punch Hit
[Statedef 291]
type    = S
movetype= A
physics = S
juggle  = 3
velset = 3,0
ctrl = 0
anim = 291
poweradd = 30
sprpriority = 2

[State 250, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, SA
damage = 100, 10
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 30, 30
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-80
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -15,-6
air.velocity = -15,-6
ground.hittime  = 30
air.hittime = 30
airguard.velocity = -1.9,-.8
fall = 1
;getpower = 0,0
envshake.time = 30
envshake.freq = 60
envshake.ampl = -8
envshake.phase = 90

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 8300
ID = 8300
pos = 0,0
postype = left
bindtime = -1
removetime = 20
pausemovetime = 99
supermovetime = 99
scale = gamewidth/640,gameheight/480
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1
persistent = 0

[State -2, Sparks]
type=helper
trigger1= movehit = 1 && numenemy
stateno=ifelse(moveguarded, var(15), var(10))
ID=9000
name="Spark"
postype=p1
pos= ifelse(p2dist x<0, (ceil(p2dist x)), ifelse(p2dist x<var(16), ceil(p2dist x), var(16))), var(17)
facing= ifelse((p2bodydist x >=-5),-1,1);-1;enemynear,facing
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1
size.xscale =1
size.yscale =1
persistent = 0

[State 250, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S6,0
volumescale = 100
channel = 0

[State 250, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Kick 1
[Statedef 300]
type    = S
movetype= A
physics = S
juggle  = 1
velset = 3,0
ctrl = 0
anim = 300
poweradd = 30
sprpriority = 2

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-85
hitsound = s1, 0
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s7, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 330

[State 240, ChangeState]
type = ChangeState
trigger1 = command = "x" && movecontact
value = 290
ctrl = 0

[State 300, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Crouch Kick 1
[Statedef 310]
type    = C
movetype= A
physics = C
juggle  = 1
velset = 0,0
ctrl = 0
anim = 310
poweradd = 25
sprpriority = 2

[State 310, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 10, 10
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-40
hitsound = s1, 1
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -4
air.velocity = -1.4,-3
ground.hittime  = 15
air.hittime = 10
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 310, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S7,0
volumescale = 100
channel = 0

[State 310, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1
;---------------------------------------------------------------------------
; Air Kick 1
[Statedef 320]
type    = A
movetype= A
physics = A
juggle  = 1
ctrl = 0
anim = 320
poweradd = 35
sprpriority = 2

[State 320, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 23, 0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-40
hitsound = s1, 2
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -4
air.velocity = -1.4,-3
ground.hittime  = 20
air.hittime = 11
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "x" && movecontact
value = 220
ctrl = 0

[State 320, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0
;---------------------------------------------------------------------------
; Stand Kick 2
[Statedef 330]
type    = A
movetype= A
physics = N
juggle  = 2
velset = 4,-4
ctrl = 0
anim = 330
poweradd = 30
sprpriority = 2

[State 0, Gravity]
type = Gravity
trigger1 = 1

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-75
hitsound = s1, 2
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s7, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 340

[State 300, ChangeState]
type = ChangeState
trigger1 = pos y > const(movement.air.gethit.groundrecover.groundlevel) && vel y > 0
value = 52
ctrl = 0
;---------------------------------------------------------------------------
; Stand Kick 2
[Statedef 331]
type    = A
movetype= A
physics = N
juggle  = 2
velset = 6,-4
ctrl = 0
anim = 330
poweradd = 30
sprpriority = 2

[State 0, Gravity]
type = Gravity
trigger1 = 1

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-75
hitsound = s1, 2
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 340

[State 300, ChangeState]
type = ChangeState
trigger1 = pos y > const(movement.air.gethit.groundrecover.groundlevel) && vel y > 0
value = 52
ctrl = 0
;---------------------------------------------------------------------------
; Stand Kick 3
[Statedef 340]
type    = A
movetype= A
physics = N
juggle  = 2
velset = 2,-2
ctrl = 0
anim = 340
poweradd = 30
sprpriority = 2

[State 0, Gravity]
type = Gravity
trigger1 = time > 6

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 23, 0
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 12, 10
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-75
hitsound = s1, 3
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -6,-6
air.velocity = -6,-5
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 1
;getpower = 0,0
envshake.time = 10
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 350

[State 300, ChangeState]
type = ChangeState
trigger1 = pos y > const(movement.air.gethit.groundrecover.groundlevel) && vel y > 0
value = 52
ctrl = 0
;---------------------------------------------------------------------------
; Stand Kick 4
[Statedef 350]
type    = A
movetype= A
physics = N
juggle  = 2
velset = 0,0
ctrl = 0
anim = 350
poweradd = 30
sprpriority = 2

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = animelem = 10
value = s6, 0+random%3
channel = 0
volumescale = 100

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S350,0
volumescale = 100
channel = 0

[State 0, Explod]
type = Explod
trigger1 = !time || animelem = 6
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 14
movetime = 14

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 6
x = -3
y = -2

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 6
x = enemy,pos x + ifelse(facing=1,80,-80)
y = enemy,pos y + 10

[State 0, Turn]
type = Turn
trigger1 = animelem = 6

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 75, 5
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 15, 15
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-75
hitsound = s1, 5
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -11,-3
air.velocity = -11,-3
ground.hittime  = 20
air.hittime = 20
airguard.velocity = -1.9,-.8
fall = 1
p2stateno = 5400
p2facing = 1
envshake.time = 15
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 0, Explod]
type = Explod
trigger1 = movehit = 1
anim = 8300
ID = 8300
pos = 0,0
postype = left
bindtime = -1
removetime = 15
pausemovetime = 99
supermovetime = 99
scale = gamewidth/640,gameheight/480
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1
persistent = 0

[State 0, Gravity]
type = Gravity
trigger1 = time > 20

[State 300, ChangeState]
type = ChangeState
trigger1 = pos y > const(movement.air.gethit.groundrecover.groundlevel) && vel y > 0
value = 52
ctrl = 0
;---------------------------------------------------------------------------
; Stand Kick 5
[Statedef 360]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 8,0
ctrl = 0
anim = 360
poweradd = 30
sprpriority = 2

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-90
hitsound = s1, 0
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 18
air.hittime = 18
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "x"
value = 240

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 330

[State 300, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Kick 6
[Statedef 370]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 8,0
ctrl = 0
anim = 370
poweradd = 30
sprpriority = 2

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Diagup
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 15
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-95
hitsound = s1, 5
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -4,-12
air.velocity = -4,-12
ground.hittime  = 40
air.hittime = 40
airguard.velocity = -1.9,-.8
fall = 1
;getpower = 0,0
envshake.time = 15
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "x" && hitshakeover
value = 270

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y" && time > 12
value = 390

[State 300, ChangeState]
type = ChangeState
triggerall = power = powermax
trigger1 = movehit && command = "z" && command = "holdup" && hitshakeover
value = 1400

[State 300, ChangeState]
type = ChangeState
triggerall = power >= 1000
trigger1 = movehit && command = "z" && hitshakeover
value = 1000

[State 300, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Kick 7
[Statedef 380]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 8,0
ctrl = 0
anim = 380
poweradd = 30
sprpriority = 2

[State 300, Hitdef]
type = HitDef
trigger1 = animelem = 3
attr = S, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-90
hitsound = s1, 1
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 18
air.hittime = 18
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, Hitdef]
type = HitDef
trigger1 = animelem = 7
attr = S, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-90
hitsound = s1, 1
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 18
air.hittime = 18
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s380, 0
channel = 0
volumescale = 100

[State 300, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3 || animelem = 7
value = s0, 1
channel = -1
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "x" && uniqhitcount = 2
value = 240

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y" && uniqhitcount = 2
value = 340

[State 300, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Air Finisher 2
[Statedef 390]
type    = A
movetype= A
physics = N
juggle  = 3
ctrl = 0
anim = 390
velset = 0,-.5
poweradd = 35
sprpriority = 2

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S350,0
volumescale = 100
channel = -1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 20
movetime = 19

[State 0, Explod]
type = Explod
trigger1 = !time || animelem = 6
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 6
x = enemy,pos x + ifelse(facing=1,80,-80)
y = ifelse(prevstateno = 445,enemy,pos y + 20,enemy,pos y - 40)

[State 0, Turn]
type = Turn
trigger1 = animelem = 7

[State 250, Hitdef]
type = HitDef
trigger1 = animelem = 10
attr = S, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 10, 10
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-50
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -1,-7
air.velocity = -1,-7
ground.hittime  = 50
air.hittime = 50
airguard.velocity = -1.9,-.8
fall = 1
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 10
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 13
value = S390,0
volumescale = 100
channel = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S390,1
volumescale = 100
channel = 0

[State 250, Hitdef]
type = HitDef
trigger1 = animelem = 13 || animelem = 14 || animelem = 15 || animelem = 16 || animelem = 17 || animelem = 18
trigger2 = animelem = 19 || animelem = 20
attr = A, SA
damage = 19, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 2, 2
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=75+random%55), var(17):=-90-random%10
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = 0,-1
air.velocity = 0,-1
ground.hittime  = 50
air.hittime = 50
airguard.velocity = -1.9,-.8
fall = 1
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 2
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 250, Hitdef]
type = HitDef
trigger1 = animelem = 21
attr = A, SA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 2, 2
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-90
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = 0,-6
air.velocity = 0,-6
ground.hittime  = 50
air.hittime = 50
airguard.velocity = -1.9,-.8
fall = 1
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 2
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 250, Hitdef]
type = HitDef
trigger1 = animelem = 26
attr = S, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 20
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-75
hitsound = s1, 6
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -2,0
air.velocity = -2,20
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 1
fall.xvelocity = .1
fall.yvelocity = 0
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 250, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, ChangeState]
type = ChangeState
triggerall = power >= 1000
trigger1 = movehit && command = "z" && hitshakeover=1 && uniqhitcount = 11
value = 1200

[State 0, Gravity]
type = Gravity
trigger1 = time > 86

[State 250, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0
value = 52
;---------------------------------------------------------------------------
; Ki 1
[Statedef 400]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 400
poweradd = -200
sprpriority = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 3
anim = 7002
ID = 7002
pos = 69,-89
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = .5,.5
sprpriority = 5
ownpal = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 3
name = "Ki Blasts"
ID = 400
stateno = 430
pos = 75,-92
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = 1
size.yscale = 1

[State 400, ChangeState]
type = ChangeState
triggerall = power >=200
trigger1 = AnimTime = 0 && command = "holdz"
value = 410
ctrl = 0

[State 400, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Ki 2
[Statedef 410]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 410
poweradd = -200
sprpriority = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 2
anim = 7002
ID = 7002
pos = 69,-84
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = .5,.5
sprpriority = 5
ownpal = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 2
name = "Ki Blasts"
ID = 400
stateno = 430
pos = 75,-84
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = 1
size.yscale = 1

[State 400, ChangeState]
type = ChangeState
triggerall = power >=200
trigger1 = AnimTime = 0 && command = "holdz"
value = 420
ctrl = 0

[State 400, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Ki 3
[Statedef 420]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 420
poweradd = -200
sprpriority = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 2
anim = 7002
ID = 7002
pos = 69,-89
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = .5,.5
sprpriority = 5
ownpal = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 2
name = "Ki Blasts"
ID = 400
stateno = 430
pos = 75,-92
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = 1
size.yscale = 1

[State 400, ChangeState]
type = ChangeState
triggerall = power >=200
trigger1 = AnimTime = 0 && command = "holdz"
value = 410
ctrl = 0

[State 400, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Ki Blast
[Statedef 430]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7000
velset = 8,0
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, VarRandom]
type = VarRandom
trigger1 = !time
v = 1
range = -1,1

[State 0, ]
type = VelSet
trigger1 = !time
trigger1 = var(1) = -1
y = -0.5

[State 0, ]
type = VelSet
trigger1 = !time
trigger1 = var(1) = 1
y = 0.5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,1
volumescale = 100
channel = -1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -(vel y)*5

[State 0, AfterImage]
type = AfterImage
trigger1 = !time
time = -1
length = 20
framegap = 1
trans = add

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 23, 1
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 4
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=50), var(17):=0
hitsound = -1
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 11
air.hittime = 11
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 0
getpower = 0,0

[State -2, Sparks]
type=helper
trigger1= movehit=1 && numenemy
stateno=ifelse(moveguarded, var(15), var(10))
ID=9000
name="Spark"
postype=p1
pos= ifelse(p2dist x<0, (ceil(p2dist x)), ifelse(p2dist x<var(16), ceil(p2dist x), var(16))), var(17)
facing= ifelse((p2bodydist x >=-5),-1,1);-1;enemynear,facing
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1
size.xscale =1
size.yscale =1

[State 0, HitOverride]
type = HitOverride
trigger1 = !time
attr = SCA,NA,SA,HA,NP,SP,HP
stateno = 435
time = 999
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = movecontact
trigger2 = pos y > 5
trigger3 = frontedgebodydist < -60
value = 435
ignorehitpause = 1

;---------------------------------------------------------------------------
; Ki Blast Hit
[Statedef 435]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7001
velset = 0,0
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = !time
time = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,0
volumescale = 100
channel = -1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -(vel y)*5

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
;---------------------------------------------------------------------------
; Air Z
[Statedef 440]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 440
sprpriority = 1

[State 200, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NT
damage = 0, 0
animtype = Medium
guardflag = 
hitflag = AF
priority = 6, Miss
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-75
hitsound = s1, 0
guardsound = s2, 0
fall = 1
p1stateno = 445
p2stateno = 450
;getpower = 0,0

[State 400, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Air Z P1
[Statedef 445]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 441
velset = 0,0
sprpriority = 1

[State 0, Gravity]
type = Gravity
trigger1 = time > 35

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s180, 2
channel = 0
volumescale = 100

[State 0, TargetBind]
type = TargetBind
trigger1 = animelem = 1
time = 10
pos = 42,-78

[State 0, TargetBind]
type = TargetBind
trigger1 = animelem = 2
time = 9
pos = 42,-98

[State 0, TargetVelSet]
type = TargetVelSet
trigger1 = time = 19
x = 8
y = -6

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "x" && time > 34
value = 271
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "y" && time > 40
value = 390
ctrl = 0

[State 445, ChangeState]
type = changestate
trigger1 = Pos y > 0 && vel y > 0
value = 52
;---------------------------------------------------------------------------
; Air Z P2
[Statedef 450]
type    = A
movetype= H
ctrl = 0
velset = 0,0
sprpriority = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = anim !=442
value = 442

[State 0, Gravity]
type = Gravity
trigger1 = time > 20

[State 445, ChangeState]
type = selfstate
trigger1 = Pos y > const(movement.down.bounce.groundlevel) && vel y > 0
value = 5100
;---------------------------------------------------------------------------
; Ki Push
[Statedef 475]
type    = S
movetype= A
physics = N
ctrl = 0
anim = 430
sprpriority = 1

[State 0, VelMul]
type = VelMul
trigger1 = 1 
x = .7

[State 0, Explod]
type = Explod
trigger1 = animelem = 3
anim = 7002
ID = 7002
pos = 69,-120
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1


[State 212, Hitdef]
type = HitDef
trigger1 = !time
attr = S, NA
damage = 50, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 20
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-120
hitsound = s1, 6
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -10,-2
air.velocity = -10,-2
ground.hittime  = 25
air.hittime = 25
yaccel = .45
airguard.velocity = -1.9,-.8
p2stateno = 5400
fall = 1
getpower = 0,0
EnvShake.time = 20
EnvShake.freq = 60
EnvShake.ampl = -8
EnvShake.phase = 90

[State 400, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Charge
[Statedef 900]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
sprpriority = 2

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = command = "holdx" && command = "holdy" && anim !=900
value = 900
persistent = 0

[State 0, PowerAdd]
type = PowerAdd
trigger1 = 1
value = 15

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 7010
ID = 7010
pos = 0,5
postype = p1
bindtime = -1
removetime = -1
pausemovetime = 0
supermovetime = 0
scale = .80,.65
sprpriority = 5
ownpal = 1
removeongethit = 1

[State 0, Explod]
type = Explod
trigger1 = time%15=0
anim = 8110
ID = 8110
pos = 0,-5
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
removeongethit = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S500,0
volumescale = 100
channel = 1

[State 0, PalFX]
type = PalFX
trigger1 = power = powermax
time = 2
add = 255,255,255

[State 0, StopSnd]
type = StopSnd
trigger1 = power = powermax
trigger2 = command != "holdx" || command != "holdy"
channel = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = power = powermax
trigger2 = command != "holdx" || command != "holdy"
id = 7010

[State 500, ChangeState]
type = ChangeState
trigger1 = power = powermax
trigger2 = command != "holdx" || command != "holdy"
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Burst Kamehameha
[Statedef 1000]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
anim = 1000
poweradd = ifelse(prevstateno = 370,-1000,-2000)
sprpriority = 1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 140
movetime = 140
pausebg = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S1000,4
volumescale = 100
channel = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !time
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 240

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 8121
ID = 8260
pos = 0,0
postype = left
removetime = -2
bindtime = -1
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 0
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 8110
ID = 8260
pos = 0,0
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 19
anim = 8400
ID = 8260
pos = -45,-90
postype = p1
removetime = -2
bindtime = -1
pausemovetime = 999
supermovetime = 999
scale = 2,2
sprpriority = 1
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 17
anim = 7010
ID = 7010
pos = 0,0
postype = p1
bindtime = -1
removetime = -1
pausemovetime = 999
supermovetime = 999
scale = .80,.65
sprpriority = 5
ownpal = 1
removeongethit = 1

[State 0, EnvShake]
type = EnvShake
trigger1 = !time 
time = 10
freq = 60
ampl = -8
phase = 90

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 19
value = S1000,0
volumescale = 100
channel = -1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 19
value = S1000,3
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 23
value = S1000,2
volumescale = 100
channel = 0

[State 250, Hitdef]
type = HitDef
trigger1 = time%6=0 && time < 210
attr = S, HP
damage = 25, 1
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 0
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8014)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-55
hitsound = s1, 3
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -5,-3
air.velocity = -1.4,-3
ground.hittime  = 30
air.hittime = 30
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
getpower = 0,0
envshake.time = 6
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 0, Explod]
type = Explod
trigger1 = uniqhitcount = 12
anim = 8210
ID = 8260
pos = 0,-50
postype = p2
facing = 1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 6
ownpal = 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = uniqhitcount = 12
value = S1000,5
volumescale = 100
channel = -1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 23
value = S1000,1
volumescale = 100
channel = -1

[State 0, Helper]
type = Helper
trigger1 = animelem = 19
name = "Kamehameha Charge"
ID = 1100
stateno = 1105
pos = -45,-90
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = animelem = 23
name = "SuperBackground"
ID = 1100
stateno = 7600
pos = 0,-60
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = animelem = 23
name = "Burst Kamehameha"
ID = 1100
stateno = 1100
pos = 20,-133
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Explod]
type = Explod
triggerall = facing=1
trigger1 = animelem = 23
anim = 8122
ID = 8260
pos = 0,0
postype = left
facing = 1
bindtime = -1
removetime = 100
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 6
ownpal = 1

[State 0, Explod]
type = Explod
triggerall = facing = -1
trigger1 = animelem = 23
anim = 8122
ID = 8260
pos = 0,0
postype = right
facing = -1
bindtime = -1
removetime = 100
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 6
ownpal = 1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 7
y = -.5

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 14
y = 0

[State 0, Gravity]
type = Gravity
trigger1 = time > 235

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time = 235
id = 7010

[State 400, ChangeState]
type = ChangeState
trigger1 = pos y > 15 && vel y > 0
value = 52
ctrl = 0
;---------------------------------------------------------------------------
; Burst Kamehameha
[Statedef 1100]
type    = A
movetype= A
physics = N
anim = 8120
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45
scale = 1,1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
;---------------------------------------------------------------------------
; Burst Kamehameha Charge
[Statedef 1105]
type    = A
movetype= A
physics = N
anim = 8125
sprpriority = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time <=20
value = 10*time
scale = .15,.15
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time >20 && time <=40
value = 10*time
scale = .25,.25
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time >40 && time <=60
value = 10*time
scale = .35,.35
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time >60
value = 10*time
scale = .35,.35
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 66
;---------------------------------------------------------------------------
; Burst Kamehameha Charge
[Statedef 1106]
type    = A
movetype= A
physics = N
anim = 8126
sprpriority = 2

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time <=20
value = 10*time
scale = .15,.15
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time >20 && time <=40
value = 10*time
scale = .25,.25
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time >40 && time <=60
value = 10*time
scale = .35,.35
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time >60
value = 10*time
scale = .35,.35
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 66
;---------------------------------------------------------------------------
; Ki Barrage
[Statedef 1200]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
anim = 1200
poweradd = ifelse(prevstateno = 270,-1000,-2000)
sprpriority = 1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 32
movetime = 31
pausebg = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S1200,3
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S1200,0
volumescale = 100
channel = -1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !time
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 195

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 8123
ID = 8260
pos = 0,0
postype = left
removetime = -2
bindtime = -1
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 0
ownpal = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
name = "Ki Blasts Charge"
ID = 1205
stateno = 1205
pos = 45,-90
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
name = "Ki Blasts Charge"
ID = 1205
stateno = 1205
pos = -25,-93
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 25
value = S1200,1
volumescale = 100
channel = -1

[State 0, Helper]
type = Helper
trigger1 = animelem = 25
name = "Ki Blasts Charge2"
ID = 1210
stateno = 1210
pos = 20,-75
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = animelem = 5
name = "SuperBackground"
ID = 1100
stateno = 7610
pos = 0,-60
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = animelem = 5 || animelem = 7 || animelem = 9 || animelem = 11 || animelem = 13 || animelem = 15 || animelem = 17
trigger2 = animelem = 19 || animelem = 21 || animelem = 23
name = "Ki Blasts Effect"
ID = 1311
stateno = 1311
pos = 49,-77
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
size.xscale = .5
size.yscale = .5

[State 0, Helper]
type = Helper
trigger1 = animelem = 5 || animelem = 7 || animelem = 9 || animelem = 11 || animelem = 13 || animelem = 15 || animelem = 17
trigger2 = animelem = 19 || animelem = 21 || animelem = 23
name = "Ki Blasts"
ID = 1300
stateno = 1300
pos = 49,-77
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = 1
size.yscale = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 6 || animelem = 8 || animelem = 10 || animelem = 12 || animelem = 14 || animelem = 16 || animelem = 18
trigger2 = animelem = 20 || animelem = 22 || animelem = 24
name = "Ki Blasts Effect"
ID = 1311
stateno = 1311
pos = 16,-71
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = .5
size.yscale = .5

[State 0, Helper]
type = Helper
trigger1 = animelem = 6 || animelem = 8 || animelem = 10 || animelem = 12 || animelem = 14 || animelem = 16 || animelem = 18
trigger2 = animelem = 20 || animelem = 22 || animelem = 24
name = "Ki Blasts"
ID = 1300
stateno = 1300
pos = 16,-71
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = 1
size.yscale = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 26
name = "Big Blast Effect"
ID = 1311
stateno = 1311
pos = 30,-60
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = 2
size.yscale = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 26
value = S1200,2
volumescale = 100
channel = -1

[State 0, Helper]
type = Helper
trigger1 = animelem = 26
name = "Big Blast"
ID = 1310
stateno = 1310
pos = 30,-60
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = 1
size.yscale = 1

[State 0, Gravity]
type = Gravity
trigger1 = time > 195

[State 400, ChangeState]
type = ChangeState
trigger1 = pos y > 15 && vel y > 0
value = 52
ctrl = 0
;---------------------------------------------------------------------------
; Ki Barrage Charge Small
[Statedef 1205]
type    = A
movetype= A
physics = N
anim = 8125
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time <=20
value = 10*time
scale = .15,.15
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 20
;---------------------------------------------------------------------------
; Ki Barrage Charge Big
[Statedef 1210]
type    = A
movetype= A
physics = N
anim = 8125
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time <=30
value = 10*time
scale = .15+time*.02,.15+time*.02
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 30
;---------------------------------------------------------------------------
; Ki Blast Special
[Statedef 1300]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7003
velset = 10,10
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,1
volumescale = 100
channel = -1

[State 0, AfterImage]
type = AfterImage
trigger1 = !time
time = -1
length = 10
framegap = 1
trans = add

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 10, 2
animtype = Medium
guardflag = MA
hitflag = MAFD
priority = 3, Hit
pausetime = 0, 8
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=50), var(17):=0
hitsound = -1
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -6,10
air.velocity = -3,10
ground.hittime  = 11
air.hittime = 11
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
down.velocity = 0,0
getpower = 0,0
envshake.time = 8
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State -2, Sparks]
type=helper
trigger1= movehit=1 && numenemy
stateno=ifelse(moveguarded, var(15), var(10))
ID=9000
name="Spark"
postype=p1
pos= ifelse(p2dist x<0, (ceil(p2dist x)), ifelse(p2dist x<var(16), ceil(p2dist x), var(16))), var(17)
facing= ifelse((p2bodydist x >=-5),-1,1);-1;enemynear,facing
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1
size.xscale =1
size.yscale =1

[State 0, HitOverride]
type = HitOverride
trigger1 = !time
attr = SCA,NA,SA,HA,NP,SP,HP
stateno = 1305
time = 999
ignorehitpause = 1

[State 0, DestroySelf]
type = ChangeState
trigger1 = movecontact
trigger2 = pos y > 5
trigger3 = frontedgebodydist < -60
value = 1305
ignorehitpause = 1
;---------------------------------------------------------------------------
; Ki Blast Hit
[Statedef 1305]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7001
velset = 0,0
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45

[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = !time
time = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,0
volumescale = 100
channel = -1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime

;---------------------------------------------------------------------------
; Ki Blast Big Special
[Statedef 1310]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7020
velset = 16,16
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,1
volumescale = 100
channel = -1

[State 0, AfterImage]
type = AfterImage
trigger1 = !time
time = -1
length = 10
framegap = 1
trans = add

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 50, 8
animtype = Medium
guardflag = MA
hitflag = MAFD
priority = 3, Hit
pausetime = 0, 12
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=50), var(17):=0
hitsound = -1
guardsound = 6, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 11
air.hittime = 11
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
down.velocity = -3,-10
getpower = 0,0
envshake.time = 12
envshake.freq = 60
envshake.ampl = -9
envshake.phase = 120

[State -2, Sparks]
type=helper
trigger1= movehit=1 && numenemy
stateno=ifelse(moveguarded, var(15), var(10))
ID=9000
name="Spark"
postype=p1
pos= ifelse(p2dist x<0, (ceil(p2dist x)), ifelse(p2dist x<var(16), ceil(p2dist x), var(16))), var(17)
facing= ifelse((p2bodydist x >=-5),-1,1);-1;enemynear,facing
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1
size.xscale =1
size.yscale =1

[State 0, DestroySelf]
type = ChangeState
trigger1 = pos y > 5
trigger2 = frontedgebodydist < -60
value = 1315
ignorehitpause = 1
;---------------------------------------------------------------------------
; Ki Blast Special Effect
[Statedef 1311]
movetype= I
anim = 7002
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime

;---------------------------------------------------------------------------
; Ki Blast Hit
[Statedef 1315]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7030
velset = 0,0
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = !time
time = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,0
volumescale = 100
channel = -1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
;---------------------------------------------------------------------------
; Burst Kamehameha Start Up
[Statedef 1400]
type    = A
movetype= A
physics = N
juggle  = 1
ctrl = 0
anim = 1400
velset = 0,0
poweradd = -3000
sprpriority = 2

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,1
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S350,0
volumescale = 100
channel = -1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 20
movetime = 20

[State 0, Explod]
type = Explod
trigger1 = !time || animelem = 5
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 5
x = enemy,pos x + ifelse(facing=1,80,-80)
y = enemy,pos y - 60

[State 0, Turn]
type = Turn
trigger1 = animelem = 6

[State 250, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 16
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-70
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -15,0
air.velocity = -15,20
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 1
fall.xvelocity = .1
fall.yvelocity = 0
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90
p1stateno = 1410
p2stateno = 1500

[State 250, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 0, Gravity]
type = Gravity
trigger1 = time > 44

[State 250, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0
value = 52

;---------------------------------------------------------------------------
; Burst Kamehameha Hit
[Statedef 1410]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 1410
velset = 0,0
sprpriority = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobg
flag2 = nofg
flag3 = nobardisplay

[State 0, Explod]
type = Explod
trigger1 = anim = 1410 && !time
anim = 8124
ID = 1400
pos = 0,0
postype = left
removetime = -2
bindtime = -1
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 0
ownpal = 1

[State 0, Helper]
type = Helper
trigger1 = anim = 1410 && animelem = 4
name = "SuperBackground"
ID = 1100
stateno = 7620
pos = 0,-60
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Explod]
type = Explod
trigger1 = time>14
anim = 7075
ID = 1400
pos = 0,-60
random = 50,60
postype = p1
removetime = -2
bindtime = 1
vel = -3,-3
pausemovetime = 999
supermovetime = 999
scale = .25,.25
sprpriority = 6
ownpal = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, Explod]
type = Explod
trigger1 = time = 50
anim = 7060
ID = 1400
pos = 0,-60
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
velocity = 2,0
scale = .5,.5
sprpriority = 6
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = time>55 && time%2=0 && anim!=1420
anim = 1411
ID = 1400
pos = 0,0
postype = p1
velocity = -1,-1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 1
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S1400,0
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 6
value = S1400,1
volumescale = 200
channel = -1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 6
x = 20
y = 20

[State 0, AllPalFX]
type = AllPalFX
trigger1 = time = 70
time = 30
sinadd = -255,-255,-255,60

[State 0, PosSet]
type = PosSet
triggerall = facing = -1
trigger1 = time = 100
x = 200
y = -200

[State 0, PosSet]
type = PosSet
triggerall = facing = 1
trigger1 = time = 100
x = -200
y = -200

[State 300, PlaySnd]
type = PlaySnd
trigger1 = time = 100
value = s180, 1
channel = 0
volumescale = 100

[State 0, VelSet]
type = VelSet
trigger1 = time = 100
x = .5
y = .5

[State 0, VelAdd]
type = VelAdd
trigger1 = time >= 120 && time <= 160
x = .05
y = .05

[State 0, VelAdd]
type = VelAdd
trigger1 = time >= 180 && time <= 250
x = -.05
y = -.075

[State 0, VelAdd]
type = VelAdd
trigger1 = time >= 260 && time <= 280
x = .05
y = .2

[State 0, VelSet]
type = VelSet
trigger1 = time = 300
x = 20
y = 20

[State 0, AllPalFX]
type = AllPalFX
trigger1 = time = 310
time = 30
sinadd = -255,-255,-255,60

[State 0, TargetState]
type = TargetState
trigger1 = time = 320
value = 1510

[State 0, PosSet]
type = PosSet
triggerall = facing = -1
trigger1 = time = 350
x = 200
y = -200

[State 0, PosSet]
type = PosSet
triggerall = facing = 1
trigger1 = time = 350
x = -200
y = -200

[State 0, VelSet]
type = VelSet
trigger1 = time = 350
x = 13
y = 13

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 350
value = 1420

[State 0, VelSet]
type = VelSet
trigger1 = anim = 1420 && time = 360
x = 0
y = 0

[State 0, Explod]
type = Explod
trigger1 = anim = 1420 && animelem = 4
anim = 1421
ID = 1400
pos = 0,0
postype = p1
removetime = 100
pausemovetime = 999
supermovetime = 999
velocity = 0,0
sprpriority = 6
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 1420
value = S1400,2
volumescale = 200
channel = 0
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 200
value = S1400,3
volumescale = 200
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 300
value = S1400,1
volumescale = 200
channel = -1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 1420
value = S1000,0
volumescale = 200
channel = -1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 1420 && animelemtime(4)=0
value = S1000,1
volumescale = 200
channel = -1
persistent = 0

[State 0, Helper]
type = Helper
trigger1 = anim = 1420 && animelemtime(4)=0
name = "Burst Kamehameha"
ID = 1420
stateno = 1420
pos = 50,-68
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = anim = 1420 && animelemtime(4)=30
name = "Burst Kamehameha"
ID = 1430
stateno = 1430
pos = 50,-68
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 250, Hitdef]
type = HitDef
trigger1 = time%3=0 && time >=400 && time <=490
attr = S, HP
damage = 20, 5
animtype = Heavy
guardflag = 
hitflag = MAFD
priority = 7, Hit
pausetime = 0, 0
guard.pausetime = 3,3
sparkno = -1 + 0*(var(10):=8014)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=75+random%35), var(17):=-20
hitsound = s1, 3
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = 0,20
air.velocity = 0,0
ground.hittime  = 120
air.hittime = 120
down.hittime = 120
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
getpower = 0,0
envshake.time = 9
envshake.freq = 60
envshake.ampl = -9
envshake.phase = 90

[State 0, AllPalFX]
type = AllPalFX
trigger1 = time = 510
time = 30
sinadd = 255,255,255,60

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time = 530

[State 0, ChangeState]
type = ChangeState
trigger1 = time = 530
value = 50

;---------------------------------------------------------------------------
; Knock Down
[Statedef 1500]
movetype= H
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 1500

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 10
y = 10

[State 0, VelSet]
type = VelSet
trigger1 = pos y > 300 && vel y > 0
x = 0
y = 0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = pos y > 300 && vel y > 0
flag = invisible
;---------------------------------------------------------------------------
; Ulte Kamehameha 1
[Statedef 1420]
type    = A
movetype= A
physics = N
anim = 8120
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -130
scale = 1,1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
;---------------------------------------------------------------------------
; Ulte Kamehameha 2
[Statedef 1430]
type    = A
movetype= A
physics = N
anim = 8130
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -130
scale = 1,1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
;---------------------------------------------------------------------------
; Down Blast Ready
[Statedef 1510]
movetype= H
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time
value = 1510

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0

;---------------------------------------------------------------------------
; KAME SB
[Statedef 7600]
type    = A
movetype= A
physics = N
anim = 7600
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 45
scale = 2,2
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time >= 95
;---------------------------------------------------------------------------
; KI BAR SB
[Statedef 7610]
type    = A
movetype= A
physics = N
anim = 7600
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45
scale = 2,2
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time >= 170
;---------------------------------------------------------------------------
; ULTI SB
[Statedef 7620]
type    = A
movetype= A
physics = N
anim = 7600
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45
scale = 2,2
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 505

;--- WEAK ---
[Statedef 8010]
type = A
physics = N
movetype = I
anim = 9999
velset = 0, 0
sprpriority = 5

[State 8010, Assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8001
ID = 3
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 3
scale = 0 +(0.1 * time), 0 +(0.1 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8000
ID = 4
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 4
scale = 0 +(0.06 * time), 0 +(0.06 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, End]
type = removeexplod
trigger1 = time >= 15
[State 8010, End]
type = destroyself
trigger1 = time >= 16

;--- MEDIUM ---
[Statedef 8011]
type = A
physics = N
movetype = I
anim = 9999
velset = 0, 0
sprpriority = 5

[State 8010, Assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8001
ID = 3
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 3
scale = 0 +(0.15 * time), 0 +(0.15 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8000
ID = 4
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 4
scale = 0 +(0.1 * time), 0 +(0.1 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, End]
type = removeexplod
trigger1 = time >= 15
[State 8010, End]
type = destroyself
trigger1 = time >= 16
;--- HEAVY ---
[Statedef 8012]
type = A
physics = N
movetype = I
anim = 9999
velset = 0, 0
sprpriority = 5

[State 8010, Assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8001
ID = 3
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 3
scale = 0 +(0.2 * time), 0 +(0.2 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8000
ID = 4
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 4
scale = 0 +(0.12 * time), 0 +(0.12 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, End]
type = removeexplod
trigger1 = time >= 15
[State 8010, End]
type = destroyself
trigger1 = time >= 16
;--- SPECIAL ---
[Statedef 8013]
type = A
physics = N
movetype = I
anim = 9999
velset = 0, 0
sprpriority = 5

[State 8010, Assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8001
ID = 3
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 3
scale = 0 +(0.3 * time), 0 +(0.3 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8000
ID = 4
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 4
scale = 0 +(0.15 * time), 0 +(0.15 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, End]
type = removeexplod
trigger1 = time >= 15
[State 8010, End]
type = destroyself
trigger1 = time >= 16
;--- HELPER ---
[Statedef 8014]
type = A
physics = N
movetype = I
anim = 9999
velset = 0, 0
sprpriority = 5

[State 0, PosSet]
type = PosSet
trigger1 = 1
x = enemy,pos x 
y = enemy,pos y - 55

[State 8010, Assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8001
ID = 3
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 3
scale = 0 +(0.2 * time), 0 +(0.2 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8000
ID = 4
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 4
scale = 0 +(0.1 * time), 0 +(0.1 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, End]
type = removeexplod
trigger1 = time >= 15
[State 8010, End]
type = destroyself
trigger1 = time >= 16
;---------------------------------------------------------------------------
; Wall Bounce
[Statedef 5400]
type    = A
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 0, ChangeAnim2]
type = ChangeAnim2
triggerall = anim != 5401
trigger1 = hitshakeover = 1 || !time
value = 5400
persistent = 0

[State 1026, Velocity]
type = VelSet
triggerall = anim = 5400
trigger1 = hitshakeover = 1
x = hitvel x
y = hitvel y

[State 1026, Gravity]
type = VelAdd
triggerall = anim = 5400
trigger1 = hitshakeover = 1
y = .45

[State 1026, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 65
trigger2 = FrontEdgeBodyDist < 65
value = 1
movecamera = 0,1

[State 1026, Hit wall]
type = ChangeState
triggerall = anim = 5400
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist <= 10
trigger2 = FrontEdgeBodyDist <= 10
value = 5401

[State 1026, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
; Wall Bounce Hitwall
[Statedef 5401]
type    = A
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 5401, EnvShake]
type = EnvShake
trigger1 = !time 
time = 10
freq = 60
ampl = -8
phase = 90

[State 5401, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
pos = 0, floor (screenpos y) - 50
postype = back
sprpriority = 3

[State 5401, Sound]
type = PlaySnd
trigger1 = Time = 0
value = F7,0

[State 5401, ChangeAnim2]
type = ChangeAnim
trigger1 = time = 10
value = 5061

[State 5401, Turn]
type = Turn
trigger1 = time = 10

[State 5401, VelSet]
type = VelSet
trigger1 = time = 10
x = -3
y = -3

[State 5401, Gravity]
type = Gravity
trigger1 = time >=10

[State 5401, Hit ground]
type = SelfState
trigger1 = Vel y > 0 && Pos y >= 0
value = 5100

;===================================================;
;               COPIED FROM COMMON1.CNS             ;
;===================================================;
;---------------------------------------------------------------------------
; GUARD (start)
[Statedef 120]
type = U   ;Leave state type unchanged
physics = U;Leave physics unchanged

[State 120]
Type=CtrlSet
Trigger1=var(59)>0
value=0

[State 120, 1]
type = ChangeAnim
trigger1 = Time = 0
value = 120 + (statetype = C) + (statetype = A)*2

[State 120, 2]
type = StateTypeSet
trigger1 = Time = 0 && statetype = S
physics = S

[State 120, 3]
type = StateTypeSet
trigger1 = Time = 0 && statetype = C
physics = C

[State 120, 4]
type = StateTypeSet
trigger1 = Time = 0 && statetype = A
physics = A

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(59)=0
trigger1 = command = "holddown"
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(59)=0
trigger1 = command!= "holddown"
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
statetype = S
physics = S

[State 120, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 130 + (statetype = C) + (statetype = A)*2

[State 120, Stop Guarding]
type = ChangeState
trigger1 = command!= "holdback"
trigger1 = var(59)=0
trigger2 =!inguarddist
value = 140

;---------------------------------------------------------------------------
; Stand guard (guarding)
[Statedef 130]
type    = S
physics = S

[State 120]
Type=CtrlSet
Trigger1=var(59)>0
value=0

[State 130, 1]
type = ChangeAnim
trigger1 = Anim!= 130
value = 130

[State 130, Hi to Lo]
type = ChangeState
trigger1 = command = "holddown"
trigger1 = var(59)=0
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
value = 131

[State 130, Stop Guarding]
type = ChangeState
trigger1 = var(59)=0
trigger1 = command!= "holdback"
trigger2 =!inguarddist
value = 140

;---------------------------------------------------------------------------
; Crouch guard (guarding)
[Statedef 131]
type    = C
physics = C

[State 120]
Type=CtrlSet
Trigger1=var(59)>0
value=0

[State 131, 1]
type = ChangeAnim
trigger1 = Anim!= 131
value = 131

[State 131, Lo to Hi]
type = ChangeState
trigger1 = command!= "holddown"
trigger1 = var(59)=0
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
value = 130

[State 131, Stop Guarding]
type = ChangeState
trigger1 = var(59)=0
trigger1 = command!= "holdback"
trigger2 =!inguarddist
value = 140

;---------------------------------------------------------------------------
; Air guard (guarding)
[Statedef 132]
type    = A
physics = N

[State 120]
Type=CtrlSet
Trigger1=var(59)>0
value=0

[State 132, 1]
type = ChangeAnim
trigger1 = Anim!= 132
value = 132

[State 132, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 132, 3]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 132, 4]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 132, 5]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 132, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback" || (var(59)>0)
trigger1 = inguarddist
value = 130

[State 132, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

[State 132, Stop Guarding]
type = ChangeState
trigger1 = var(59)=0
trigger1 = command!= "holdback"
trigger2 =!inguarddist
value = 140


;---------------------------------------------------------------------------
; Stand guard hit (shaking)
[Statedef 150]
type    = S
movetype= H
physics = N
velset = 0,0

[State 150, 1]
type = ChangeAnim
trigger1 = 1
value = 150

[State 150, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(StateType=C)

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(59)=0
trigger1 = command = "holddown"
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(59)=0
trigger1 = command!= "holddown"
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
statetype = S
physics = S

[State 150, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 3

;---------------------------------------------------------------------------
; Stand guard hit (knocked back)
[Statedef 151]
type    = S
movetype= H
physics = S
anim = 150

[State 151, 1]
type = VelSet
trigger1 = Time = 0
x = HitVel x

[State 151, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
trigger1 = var(59)=0
value = 1

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(59)=0
trigger1 = command = "holddown"
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(59)=0
trigger1 = command!= "holddown"
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
statetype = S
physics = S

[State 151, 4]
type = ChangeState
trigger1 = HitOver
value = 130
ctrl =!var(59)

;---------------------------------------------------------------------------
; Crouch guard hit (shaking)
[Statedef 152]
type    = C
movetype= H
physics = N
velset = 0,0

[State 152, 1]
type = ChangeAnim
trigger1 = 1
value = 151

[State 152, 3]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(StateType=C)

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(59)=0
trigger1 = command = "holddown"
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(59)=0
trigger1 = command!= "holddown"
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
statetype = S
physics = S

[State 152, 4]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;---------------------------------------------------------------------------
; Crouch guard hit (knocked back)
[Statedef 153]
type    = C
movetype= H
physics = C
anim = 151

[State 153, 1]
type = VelSet
trigger1 = Time = 0
x = HitVel x

[State 153, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
trigger1 = var(59)=0
value = 1

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(59)=0
trigger1 = command = "holddown"
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(59)=0
trigger1 = command!= "holddown"
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
statetype = S
physics = S

[State 153, 4]
type = ChangeState
trigger1 = HitOver
value = 131
ctrl =!var(59)

;---------------------------------------------------------------------------
; Air guard hit (shaking)
[Statedef 154]
type    = A
movetype= H
physics = N
velset = 0,0

[State 154, 1]
type = ChangeAnim
trigger1 = 1
value = 152

[State 154, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 155;AGUARDHIT2

[State 154, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;---------------------------------------------------------------------------
; Air guard hit (knocked away)
[Statedef 155]
type    = A
movetype= H
physics = N
anim = 152

[State 155, 1]
type = VelSet
trigger1 = Time = 0
x = HitVel x
y = HitVel y

[State 155, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
trigger1 = var(59)=0
value = 1

[State 155, 4]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 155, 5]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback" || var(59)>0
trigger1 = inguarddist
value = 130

[State 155, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52
;===================================================;
;              -2 STATES (ALWAYS ACTIVE)            ;
;===================================================;
[Statedef -2]
;============================ HITSPARKS ==================================
[State -2, Hit Detection]
type=varset
trigger1= movecontact!=1
var(30)=2
ignorehitpause=1

[State -2, Sparks]
type=helper
triggerall= movecontact=1 && var(30)=1
trigger1= movehit=1 && numenemy
trigger1= var(10)=8010 || var(10)=8011 || var(10)=8012 || var(10)=8013 || var(10)=8014
trigger2= moveguarded=1 && numenemy
trigger2= var(15)=9002 || var(15)=9003 || var(15)=9004 || var(15)=9005
stateno=ifelse(moveguarded, var(15), var(10))
ID=9000
name="Spark"
postype=p1
pos= ifelse(p2dist x<0, (ceil(p2dist x)), ifelse(p2dist x<var(16), ceil(p2dist x), var(16))), var(17)
facing= ifelse((p2bodydist x >=-5),-1,1);-1;enemynear,facing
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1
size.xscale =1
size.yscale =1

[State -2, Hit Detection]
type=varrangeset
trigger1= movetype=I
trigger2= movetype=H && time
first=30
last=36
value=-1
ignorehitpause=1

[State -2, Hit Detection]
type=varadd
trigger1= var(30)>0
var(30)=-1
ignorehitpause=1
;--------------------------------------------------------------
[State -2, P2 Facing]
type=targetfacing
trigger1= movecontact=1 && numtarget
trigger1= !(target,hitshakeover) && !(target,hitfall) && (target,time<=1)
value= ifelse(p2dist x>=0, -1, 1)
ignorehitpause=1

[State -2, Damage based on hits]
type=varset
trigger1= numenemy
fvar(12)= enemynear,gethitvar(hitcount)
ignorehitpause=1

[State -2, Reset var when the opponent recovers]
type=varset
trigger1= numenemy
trigger1= (enemynear,movetype!=H)
trigger2= !numenemy
fvar(12)=1

[State -2, RemapPal]
type = RemapPal
trigger1 = command = "start" && command = "holddown"
trigger2 = command = "start" && command = "holdfwd"
trigger3 = command = "start" && command = "holdback"
source = 1,1
dest = 1,var(40)+1

[State -2, VarSet]
type = VarSet
trigger1 = command = "start" && command = "holddown"
trigger2 = command = "start" && command = "holdfwd"
trigger3 = command = "start" && command = "holdback"
v = 40
value = (var(40)+1) % 47

;===================================================;
;              -3 STATES (CALLED UPON)              ;
;===================================================;
[Statedef -3]

[State -3, Jump Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 40
value = 40, 0

[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52
value = 52, 0

[State -3, Hurt Sounds]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 5000 && random <500
value = 5000, 0+random%10
channel = 0
volumescale = 100