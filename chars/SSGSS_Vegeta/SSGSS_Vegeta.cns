; ADD004 BASIC PIEs ReBuilded CNS (21-10-2016)
;==============================================
; This file is Made by PIE.
; there is a backup of this file in the same folder, named "<samename>.a4bk".
; to Restore, use assist tool, or delete this file, then remove ".a4bk" from the neme of backup.
;==============================================

[Data]
life = 1000
attack = 100
defence = 100
power = 3000
fall.defence_up = 50
liedown.time = 60
airjuggle = 15
sparkno = 2
guard.sparkno = 40
KO.echo = 0
IntPersistIndex = 60
FloatPersistIndex = 40

[Size]
xscale = 1
yscale = 1
ground.back = 30
ground.front = 31
air.back = 26
air.front = 24
height = 60
attack.dist = 160
proj.attack.dist = 90
proj.doscale = 0
head.pos = 4, -92
mid.pos = -2, -64
shadowoffset = 0
draw.offset = 0,0

[Velocity]
walk.fwd  = 2.4
walk.back = -2.2
run.fwd  = 9, 0
run.back = -9,-3.8
jump.neu = 0,-11
jump.back = -2.55
jump.fwd = 2.5
runjump.back = -7,-11
runjump.fwd = 7,-11
airjump.neu = 0,-11
airjump.back = -4
airjump.fwd = 4
air.gethit.groundrecover = -.15,-3.5
air.gethit.airrecover.mul = .5,.2
air.gethit.airrecover.add = 0,-4.5
air.gethit.airrecover.back = -1
air.gethit.airrecover.fwd = 0
air.gethit.airrecover.up = -2
air.gethit.airrecover.down = 1.5

[Movement]
airjump.num = 1
airjump.height = 35
yaccel = .65
stand.friction = .85
crouch.friction = .82
stand.friction.threshold = 2
crouch.friction.threshold = .05
air.gethit.groundlevel = 25
air.gethit.groundrecover.ground.threshold = -20
air.gethit.groundrecover.groundlevel = 20
air.gethit.airrecover.threshold = -1
air.gethit.airrecover.yaccel = .35
air.gethit.trip.groundlevel = 15
down.bounce.offset = 0, 20
down.bounce.yaccel = .4
down.bounce.groundlevel = 12
down.friction.threshold = .05

[Quotes]
victory1 = "Bow down before the Prince of all Saiyans!"
victory2 = "Now that I'am a god, No one can defeat me! I'm the strongest in the Universe!"
victory3 = "You must defeat Kakarotto to stand a chance."
;---------------------------------------------------------------------------
; Stand / Tired Stand
[Statedef 0]
type = S
physics = S
sprpriority = 0

[State 0, Standing animation / Tired animation]
Type = ChangeAnim
Trigger1 = Anim != IfElse (Life <= 200, 1, 0) && Anim != 5
Trigger2 = Anim = 5 && AnimTime = 0 ;Turn anim over
Value = IfElse (Life <= 200 , 1, 0)
elem = ifelse(anim = 5, 3,1)

[State 0, 2]
type = VelSet
trigger1 = Time = 0
y = 0

[State 0, 3] ;Stop moving if low velocity or 4 ticks pass
type = VelSet
trigger1 = abs(vel x) < Const(movement.stand.friction.threshold)
trigger2 = Time = 4
x = 0

[State 0, 4] ;Are you dead?
type = ChangeState
trigger1 = !alive
value = 5050
ctrl = 0
;---------------------------------------------------------------------------
; Dash
[Statedef 100]
type = S
physics = N
ctrl = 0
anim = 100
movetype = I
sprpriority = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nowalk

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,0
volumescale = 100
channel = -1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 3
x = 15
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = time > 10
x = .9

[State 1000, Explod]
type = Explod
trigger1 = time >0 && time <20
anim = 7050
ID = 7050
pos = 0,-70
random = 0,80
velocity = -5,0
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 999
scale = 1,1
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 1000, Explod]
type = Explod
trigger1 = time%3=0 && time >0
anim = 8100
ID = 8100
pos = 20,5
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 6
value = 1

[State 195, 2]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Dash Air
[Statedef 101]
type = A
physics = N
ctrl = 0
anim = 101
movetype = I
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,0
volumescale = 100
channel = -1

[State 1000, Explod]
type = Explod
trigger1 = time >0 && time <20
anim = 7050
ID = 7050
pos = 0,-65
random = 0,90
velocity = -5,0
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 15
y = -1

[State 0, VelMul]
type = VelMul
trigger1 = time > 10
x = .9

[State 0, Gravity]
type = Gravity
trigger1 = time > 10

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 3
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0 
value = 52

;---------------------------------------------------------------------------
; Dash Back
[Statedef 105]
type = S
physics = N
ctrl = 0
anim = 105
movetype = I
sprpriority = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nowalk

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,0
volumescale = 100
channel = -1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 2
x = -15
y = 0

[State 0, VelMul]
type = VelMul
trigger1 = time > 8
x = .9

[State 1000, Explod]
type = Explod
trigger1 = time >0 && time <20
anim = 7050
ID = 7050
pos = 0,-70
random = 0,80
velocity = 5,0
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 1000, Explod]
type = Explod
trigger1 = time%3=0 && time >0
anim = 8100
ID = 8100
pos = 20,5
postype = p1
facing = -1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = .5,.5
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 6
value = 1

[State 195, 2]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Dash Back Air
[Statedef 106]
type = A
physics = N
ctrl = 0
anim = 106
movetype = I
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S100,0
volumescale = 100
channel = -1

[State 1000, Explod]
type = Explod
trigger1 = time >0 && time <20
anim = 7050
ID = 7050
pos = 0,-65
random = 0,90
velocity = 5,0
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = -15
y = -1

[State 0, VelMul]
type = VelMul
trigger1 = time > 8
x = .9

[State 0, Gravity]
type = Gravity
trigger1 = time > 10

[State 0, CtrlSet]
type = CtrlSet
trigger1 = time = 3
value = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0 
value = 52

;---------------------------------------------------------------------------
; Lose by Time Over
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; Win state decider
[Statedef 180]
type = S

[State 180, 1] ; THIS IS A "RE-DIRECTOR" CODE.
type = ChangeState
trigger1 = Time = 0
value = 181

;---------------------------------------------------------------------------
; Win pose 1
[Statedef 181]
type = S
movetype = I
ctrl = 0
anim = 181
velset = 0,0

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 300, PlaySnd]
type = PlaySnd
trigger1 = time = 40
value = s190, 1
channel = -1
volumescale = 100

[State 0, AllPalFX]
type = AllPalFX
trigger1 = time = 40
time = 4
add = 255,255,255

[State 0, Explod]
type = Explod
trigger1 = time = 40
anim = 182
ID = 8110
pos = 0,20
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = .5,.75
sprpriority = 5
ownpal = 1
removeongethit = 1

[State 0, Explod]
type = Explod
trigger1 = time = 40
anim = 8110
ID = 8110
pos = 0,-5
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
removeongethit = 1

[State 300, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = s180, 3
channel = 0
volumescale = 100

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time < 300
flag = roundnotover

;---------------------------------------------------------------------------
; Introduction
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0

[State 191, 1]
type = ChangeAnim
trigger1 = RoundState = 0
value = 190

[State 191, 2]
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 0, AllPalFX]
type = AllPalFX
trigger1 = animelem = 7
time = 4
add = 255,255,255

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 3
time = 98
freq = 120
ampl = -1
phase = 90

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 7
time = 20
freq = 120
ampl = -7
phase = 90

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = S190,7
volumescale = 100
channel = -1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = S190,0
volumescale = 100
channel = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S190,1
volumescale = 100
channel = 1

[State 0, Explod]
type = Explod
trigger1 = time%4=0 && time > 20 && time < 136
anim = 8006+random%4
ID = 8006
pos = 10,-20
postype = p1
random = 50,50
velocity = 0,0;-6+random%12,0
accel = 0,-.1
facing = 1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
removeongethit = 1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 3
anim = 7010
ID = 7010
pos = 0,0
postype = p1
removetime = 98
pausemovetime = 999
supermovetime = 999
scale = .75,.75;gameheight/128
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelemtime(7)=5
anim = 191
ID = 191
pos = 0,0
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 6
anim = 8030
ID = 8030
pos = 5,35
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,1;gameheight/128
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 7
anim = 182
ID = 8260
pos = 0,0
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 7
anim = 8110
ID = 8260
pos = 0,0
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 7
anim = 8050
ID = 8050
pos = 55,-80
postype = p1
scale = 0,0
pausemovetime = 999
supermovetime = 999
ownpal = 1
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = 1
ID = 8050
anim = 8050
postype = p1
pausemovetime = 999
supermovetime = 999
scale = 0+time*0.5,0+time*0.5
removetime = 30
sprpriority = 5
ontop = 0
ownpal = 1
ignorehitpause = 1
;trans = addalpha
;alpha = 256-(time*32), 256

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = S190,3
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S190,4
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 11 && enemy,name = "Super Saiyan God Super Saiyan Goku"
value = S190,6
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 11 && enemy,name != "Super Saiyan God Super Saiyan Goku"
value = S190,5
volumescale = 100
channel = 0

[State 0, StopSnd]
type = StopSnd
trigger1 = roundstate = 2
channel = -1

[State 191, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; Taunt
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 2

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Stand Punch 1
[Statedef 200]
type    = S
movetype= A
physics = S
juggle  = 1
velset = 3,0
ctrl = 0
anim = 200
poweradd = 30
sprpriority = 2

[State 200, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-65
hitsound = s1, 0
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -4
air.velocity = -1.4,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 200, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "x" && movecontact
value = 230
ctrl = 0

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 330

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 200, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Crouch Punch 1
[Statedef 210]
type    = C
movetype= A
physics = C
juggle  = 1
velset = 0,0
ctrl = 0
anim = 210
poweradd = 25
sprpriority = 2

[State 205, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 10, 10
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-20
hitsound = s1, 1
guardsound = s2, 0
ground.type = Trip
air.type = Trip
ground.slidetime = 5
ground.velocity = -4
air.velocity = -1.4,-3
ground.hittime  = 11
air.hittime = 11
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 210, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "y" && movecontact && command = "holddown"
value = 360
ctrl = 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s7, 0+random%3
channel = 0
volumescale = 100

[State 210, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1
;---------------------------------------------------------------------------
; Air Punch 1
[Statedef 220]
type    = A
movetype= A
physics = A
juggle  = 1
ctrl = 0
anim = 220
poweradd = 35
sprpriority = 2

[State 0, VelMul]
type = VelMul
triggerall = prevstateno = 101 || prevstateno = 106
trigger1 = movehit
x = .5

[State 220, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 23, 0
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=60), var(17):=-40
hitsound = s1, 1
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -4
air.velocity = -4,5
ground.hittime  = 20
air.hittime = 11
airguard.velocity = -1.9,-.8
fall = ifelse(p2statetype = A, 1,0)
down.bounce = 1
down.velocity = -3,-10
;getpower = 0,0

[State 220, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "z" && movecontact
value = 440
ctrl = 0

;---------------------------------------------------------------------------
; Stand Punch 2
[Statedef 230]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 6,0
ctrl = 0
anim = 250
poweradd = 30
sprpriority = 2

[State 200, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-95
hitsound = s1, 1
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -7
air.velocity = -2,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 200, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "x" && movecontact
value = 240
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "y" && movecontact
value = 360
ctrl = 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s7, 0+random%3
channel = 0
volumescale = 100

[State 200, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Punch 3
[Statedef 240]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 6,0
ctrl = 0
anim = 260
poweradd = 30
sprpriority = 2

[State 240, Hitdef]
type = HitDef
trigger1 = animelem = 3
attr = S, NA
damage = 35, 0
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 12, 12
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-70
hitsound = s1, 2
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -7
air.velocity = -2,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 240, Hitdef]
type = HitDef
trigger1 = animelem = 4
attr = S, NA
damage = 35, 0
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 12, 12
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-70
hitsound = s1, 2
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -7
air.velocity = -2,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 240, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 240, ChangeState]
type = ChangeState
trigger1 = command = "x" && movecontact
value = 250
ctrl = 0

[State 240, ChangeState]
type = ChangeState
trigger1 = command = "y" && movecontact
value = 360
ctrl = 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 240, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Punch 4
[Statedef 250]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 0,0
ctrl = 0
anim = 270
poweradd = 30
sprpriority = 2

[State 250, Hitdef]
type = HitDef
trigger1 = animelem = 5
attr = S, NA
damage = 75, 5
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 20
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-55
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = 0,0
air.velocity = -3,-3
ground.hittime  = 30
air.hittime = 30
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 250, Hitdef]
type = HitDef
trigger1 = animelem = 6
attr = S, NA
damage = 75, 5
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 20
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-55
hitsound = s1, 3
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -12,-5
air.velocity = -12,-5
ground.hittime  = 30
yaccel = 1
air.hittime = 30
airguard.velocity = -1.9,-.8
fall = 1
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 0, Helper]
type = Helper
trigger1 = animelem = 6
name = "Ki Burst"
ID = 251
stateno = 251
pos = 55,-69
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Explod]
type = Explod
trigger1 = movehit = 1
anim = 8300
ID = 8300
pos = 0,0
postype = left
bindtime = -1
removetime = 20
pausemovetime = 99
supermovetime = 99
scale = gamewidth/640,gameheight/480
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1
persistent = 0

[State 250, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s6, 0+random%3
channel = 0
volumescale = 100

[State 250, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Small Burst Beam
[Statedef 251]
type    = A
movetype= A
physics = N
anim = 8131
sprpriority = 5

[State 0, BindToParent]
type = BindToParent
trigger1 = !time
time = -1
pos = 55,-69

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -75
scale = .5,1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
;---------------------------------------------------------------------------
; Stand Punch 5
[Statedef 260]
type    = S
movetype= A
physics = N
juggle  = 2
ctrl = 0
anim = 240
poweradd = 30
sprpriority = 2

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = .9

[State 250, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 20
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-85
hitsound = s1, 5
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -3,0
air.velocity = -3,-3
ground.hittime  = 30
air.hittime = 30
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 250, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 250, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Air Finisher
[Statedef 270]
type    = A
movetype= A
physics = N
juggle  = 1
ctrl = 0
anim = 280
velset = ifelse(prevstateno = 445,-2,-.5),ifelse(prevstateno = 445,1,-.5)
poweradd = 35
sprpriority = 2

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S350,0
volumescale = 100
channel = -1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 20
movetime = 20

[State 0, Explod]
type = Explod
trigger1 = !time || animelem = 5
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 5
x = enemy,pos x + ifelse(facing=1,50,-50)
y = ifelse(prevstateno = 445,enemy,pos y + 40,enemy,pos y - 40)

[State 0, Turn]
type = Turn
trigger1 = animelem = 6

[State 250, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 16
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-70
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -15,0
air.velocity = -20,20
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 1
fall.xvelocity = .1
fall.yvelocity = 0
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 250, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s6, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y" && hitshakeover = 1
value = 390

[State 300, ChangeState]
type = ChangeState
triggerall = power >= 1000
trigger1 = movehit && command = "z" && hitshakeover=1
value = 1200

[State 0, Gravity]
type = Gravity
trigger1 = time > 30

[State 250, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0
value = 52
;---------------------------------------------------------------------------
; Stand Kick 1
[Statedef 300]
type    = S
movetype= A
physics = S
juggle  = 1
velset = 3,0
ctrl = 0
anim = 300
poweradd = 30
sprpriority = 2

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-85
hitsound = s1, 0
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s7, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 330

[State 300, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Crouch Kick 1
[Statedef 310]
type    = C
movetype= A
physics = C
juggle  = 1
velset = 0,0
ctrl = 0
anim = 310
poweradd = 25
sprpriority = 2

[State 310, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 10, 10
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-40
hitsound = s1, 1
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -4
air.velocity = -1.4,-3
ground.hittime  = 15
air.hittime = 10
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 310, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S7,0
volumescale = 100
channel = 0

[State 310, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1
;---------------------------------------------------------------------------
; Air Kick 1
[Statedef 320]
type    = A
movetype= A
physics = A
juggle  = 1
ctrl = 0
anim = 320
poweradd = 35
sprpriority = 2

[State 0, VelMul]
type = VelMul
triggerall = prevstateno = 101 || prevstateno = 106
trigger1 = movehit
x = .8

[State 320, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 23, 0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-40
hitsound = s1, 2
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -4
air.velocity = -1.4,-3
ground.hittime  = 20
air.hittime = 11
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 0, ChangeState]
type = ChangeState
trigger1 = command = "x" && movecontact
value = 220
ctrl = 0

[State 320, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0
;---------------------------------------------------------------------------
; Stand Kick 2
[Statedef 330]
type    = S
movetype= A
physics = N
juggle  = 2
velset = 1,0
ctrl = 0
anim = 330
poweradd = 30
sprpriority = 2

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=80), var(17):=-95
hitsound = s1, 2
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%2
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "x"
value = 240

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 340

[State 300, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Kick 3
[Statedef 340]
type    = S
movetype= A
physics = N
juggle  = 2
velset = 4,0
ctrl = 0
anim = 340
poweradd = 30
sprpriority = 2

[State 250, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 75, 5
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 20
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-95
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -7,-3
air.velocity = -7,-3
ground.hittime  = 30
air.hittime = 30
airguard.velocity = -1.9,-.8
fall = 1
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 0, Explod]
type = Explod
trigger1 = movehit = 1
anim = 8300
ID = 8300
pos = 0,0
postype = left
bindtime = -1
removetime = 20
pausemovetime = 99
supermovetime = 99
scale = gamewidth/640,gameheight/480
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1
persistent = 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "z" && power >= 500
value = 1100
ctrl = 0

[State 300, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Kick 4
[Statedef 350]
type    = A
movetype= A
physics = N
juggle  = 2
ctrl = 0
anim = 350
poweradd = 30
sprpriority = 2

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 0, VelMul]
type = VelMul
trigger1 = 1
x = .9

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = ifelse(prevstateno = 360,10,vel x)
y = -2

[State 300, PlaySnd]
type = PlaySnd
trigger1 = animelem = 10
value = s6, 0+random%3
channel = 0
volumescale = 100

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 75, 5
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 15, 15
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-75
hitsound = s1, 5
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -11,-3
air.velocity = -11,-3
ground.hittime  = 20
air.hittime = 20
airguard.velocity = -1.9,-.8
fall = 1
p2stateno = 5400
p2facing = 1
envshake.time = 15
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 0, Explod]
type = Explod
trigger1 = movehit = 1
anim = 8300
ID = 8300
pos = 0,0
postype = left
bindtime = -1
removetime = 15
pausemovetime = 99
supermovetime = 99
scale = gamewidth/640,gameheight/480
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1
persistent = 0

[State 0, Gravity]
type = Gravity
trigger1 = time > 13

[State 300, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0
value = 52
ctrl = 0
;---------------------------------------------------------------------------
; Stand Kick 5
[Statedef 360]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 8,0
ctrl = 0
anim = 360
poweradd = 30
sprpriority = 2

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 8, 8
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-90
hitsound = s1, 0
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 18
air.hittime = 18
airguard.velocity = -1.9,-.8
fall = 0
;getpower = 0,0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s5, 0+random%3
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y" && command = "holdup"
value = 370

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y"
value = 350

[State 300, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Stand Kick 6
[Statedef 370]
type    = S
movetype= A
physics = S
juggle  = 2
velset = 8,0
ctrl = 0
anim = 370
poweradd = 30
sprpriority = 2

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NA
damage = 23, 0
animtype = Diagup
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 15
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-95
hitsound = s1, 5
guardsound = s2, 0
ground.type = High
air.type = High
ground.slidetime = 5
ground.velocity = -4,-12
air.velocity = -4,-12
ground.hittime  = 40
air.hittime = 40
airguard.velocity = -1.9,-.8
fall = 1
;getpower = 0,0
envshake.time = 15
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 300, PlaySnd]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s370, 0
channel = 0
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "x" && hitshakeover
value = 270

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y" && hitshakeover
value = 380

[State 300, ChangeState]
type = ChangeState
triggerall = power >= 1000
trigger1 = movehit && command = "z" && hitshakeover
value = 1000

[State 300, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Air Finisher
[Statedef 380]
type    = A
movetype= A
physics = N
juggle  = 2
velset = 0,0
ctrl = 0
anim = 380
poweradd = 30
sprpriority = 2

[State 0, Pause]
type = Pause
trigger1 = !time
time = 20
movetime = 20

[State 0, Explod]
type = Explod
trigger1 = !time || animelem = 5
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = time < 20
value = 0
movecamera = 0,0

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 5
x = enemy,pos x + ifelse(facing=1,80,-80)
y = ifelse(prevstateno = 445,enemy,pos y + 40,enemy,pos y - 60)

[State 0, Turn]
type = Turn
trigger1 = animelem = 6

[State 250, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 16
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=45), var(17):=-70
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -15,0
air.velocity = -20,15
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 1
fall.xvelocity = .1
fall.yvelocity = 0
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s350, 0
channel = -1
volumescale = 100

[State 300, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3 || animelem = 7
value = s0, 1
channel = -1
volumescale = 100

[State 300, ChangeState]
type = ChangeState
trigger1 = movehit && command = "y" && hitshakeover = 1
value = 390

[State 300, ChangeState]
type = ChangeState
triggerall = power = 3000
trigger1 = movehit && command = "z" && hitshakeover = 1 && command = "holdup"
value = 1400

[State 300, ChangeState]
type = ChangeState
triggerall = power >= 1000
trigger1 = movehit && command = "z" && hitshakeover=1
value = 1200

[State 0, Gravity]
type = Gravity
trigger1 = time > 42

[State 250, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0
value = 52
;---------------------------------------------------------------------------
; Air Finisher 2
[Statedef 390]
type    = A
movetype= A
physics = N
juggle  = 2
velset = 0,0
ctrl = 0
anim = 390
poweradd = 30
sprpriority = 2

[State 0, Pause]
type = Pause
trigger1 = !time
time = 20
movetime = 20

[State 0, Explod]
type = Explod
trigger1 = !time || animelem = 5
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 5
x = enemy,pos x + ifelse(facing=1,80,-80)
y = 30

[State 0, Turn]
type = Turn
trigger1 = animelem = 6

[State 250, Hitdef]
type = HitDef
trigger1 = animelem = 10
attr = A, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 16
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=25), var(17):=-100
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -1,0-10
air.velocity = -1,-10
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
snap = 20, -30
fall = 1
fall.xvelocity = .1
fall.yvelocity = 0
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 14
value = S390,0
volumescale = 100
channel = 0

[State 250, Hitdef]
type = HitDef
trigger1 = animelem = 15
attr = A, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 16
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=45), var(17):=-70
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -10,-1
air.velocity = -10,-1
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 1
fall.xvelocity = .1
fall.yvelocity = 0
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90
p2stateno = 5400

[State 0, Explod]
type = Explod
trigger1 = animelem = 15 && movehit = 1
anim = 8300
ID = 8300
pos = 0,0
postype = left
bindtime = -1
removetime = 20
pausemovetime = 99
supermovetime = 99
scale = gamewidth/640,gameheight/480
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1
persistent = 1

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s350, 0
channel = -1
volumescale = 100

[State 300, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3 || animelem = 7
value = s0, 0
channel = -1
volumescale = 100

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 10
x = 1
y = -8

[State 0, VelMul]
type = VelMul
trigger1 = time > 36 && time < 46
y = .75

[State 0, Gravity]
type = Gravity
trigger1 = time > 60

[State 250, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0
value = 52
;---------------------------------------------------------------------------
; Special 
[Statedef 400]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 10,0
anim = 400
sprpriority = 1

[State 200, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NT
damage = 5, 0
animtype = Medium
guardflag = 
hitflag = MF
priority = 6, Miss
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-75
hitsound = s1, 0
guardsound = s2, 0
fall = 1
p1stateno = 410
p2stateno = 420
;getpower = 0,0

[State 400, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Special Hit
[Statedef 410]
type    = S
movetype= A
physics = S
ctrl = 0
velset = 0,0
anim = 410
sprpriority = 1

[State 0, Explod]
type = Explod
trigger1 = animelemtime(4)>0 && time%4=0 && animelemtime(5)<0
anim = 7075
ID = 7075
pos = 50,-60
postype = p1
facing = -1
vel = 6,-5
removetime = -2
pausemovetime = 99
supermovetime = 99
scale = 1,1
sprpriority = -1
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
name = "Effect"
ID = 415
stateno = 415
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, HitAdd]
type = HitAdd
trigger1 = time>=26 && time%5=0 && time<=46
value = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,2
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time>=26 && time%5=0 && time<=46
value = S1,1
volumescale = 100
channel = -1

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = time>=26 && time%5=0 && time<=46
value = -25
absolute = 1

[State 400, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Special Hit Effect
[Statedef 415]
movetype= I
anim = 7022
sprpriority = 5

[State 0, BindToParent]
type = BindToParent
trigger1 = !time
time = 999
pos = 40,-60

[State 0, Trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 228,256
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -160
scale = 2,1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 20
;---------------------------------------------------------------------------
; Hit Special P2
[Statedef 420]
type    = S
movetype= H
physics = N
ctrl = 0
velset = 0,0
sprpriority = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time 
value = 420

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 12 
x = -12
y = -4

[State 0, Gravity]
type = Gravity
trigger1 = time > 51

[State 400, ChangeState]
type = Selfstate
trigger1 = pos y > 20 && vel y > 0
value = 5100
ctrl = 0
;---------------------------------------------------------------------------
; Crouch Special
[Statedef 425]
type    = C
movetype= A
physics = C
ctrl = 0
velset = 0,0
anim = 425
sprpriority = 1

[State 200, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = S, NT
damage = 0, 0
animtype = Medium
guardflag = 
hitflag = MF
priority = 6, Miss
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=90), var(17):=-75
hitsound = s1, 0
guardsound = s2, 0
fall = 1
p1stateno = 410
p2stateno = 420
;getpower = 0,0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S425,0
volumescale = 100
channel = 0

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
name = "Dirty Fireworks"
ID = 426
stateno = 426
pos = 30,-139
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = .25
size.yscale = .25

[State 400, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 10
ctrl = 1

;---------------------------------------------------------------------------
; Dirty Fireworks
[Statedef 426]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 426
velset = 5,-5
sprpriority = 5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,1
volumescale = 100
channel = -1

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 75, 2
animtype = Medium
guardflag = MA
hitflag = MAFD
priority = 3, Hit
pausetime = 0, 8
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=0), var(17):=0
hitsound = -1
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -3,-4
air.velocity = -3,-4
ground.hittime  = 11
air.hittime = 11
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
getpower = 0,0
envshake.time = 8
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 0, Explod]
type = Explod
trigger1 = movehit = 1
anim = 8020
ID = 8020
pos = 0,0
postype = p1  ;p2,front,back,left,right
removetime = -2
pausemovetime = 0
scale = .25,.25
sprpriority = 5
ownpal = 1

[State -2, Sparks]
type=helper
trigger1= movehit=1 && numenemy
stateno=ifelse(moveguarded, var(15), var(10))
ID=9000
name="Spark"
postype=p1
pos= ifelse(p2dist x<0, (ceil(p2dist x)), ifelse(p2dist x<var(16), ceil(p2dist x), var(16))), var(17)
facing= ifelse((p2bodydist x >=-5),-1,1);-1;enemynear,facing
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1
size.xscale =1
size.yscale =1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = movecontact

;---------------------------------------------------------------------------
; Ki Blast
[Statedef 430]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7000
velset = 8,0
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, VarRandom]
type = VarRandom
trigger1 = !time
v = 1
range = -1,1

[State 0, ]
type = VelSet
trigger1 = !time
trigger1 = var(1) = -1
y = -0.5

[State 0, ]
type = VelSet
trigger1 = !time
trigger1 = var(1) = 1
y = 0.5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,1
volumescale = 100
channel = -1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -(vel y)*5

[State 0, AfterImage]
type = AfterImage
trigger1 = !time
time = -1
length = 20
framegap = 1
trans = add

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 23, 1
animtype = Medium
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 4
sparkno = -1 + 0*(var(10):=8010)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=50), var(17):=0
hitsound = -1
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -6
air.velocity = -1.4,-3
ground.hittime  = 11
air.hittime = 11
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 0
getpower = 0,0

[State -2, Sparks]
type=helper
trigger1= movehit=1 && numenemy
stateno=ifelse(moveguarded, var(15), var(10))
ID=9000
name="Spark"
postype=p1
pos= ifelse(p2dist x<0, (ceil(p2dist x)), ifelse(p2dist x<var(16), ceil(p2dist x), var(16))), var(17)
facing= ifelse((p2bodydist x >=-5),-1,1);-1;enemynear,facing
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1
size.xscale =1
size.yscale =1

[State 0, HitOverride]
type = HitOverride
trigger1 = !time
attr = SCA,NA,SA,HA,NP,SP,HP
stateno = 435
time = 999
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = movecontact
trigger2 = pos y > 5
trigger3 = frontedgebodydist < -60
value = 435
ignorehitpause = 1

;---------------------------------------------------------------------------
; Ki Blast Hit
[Statedef 435]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7001
velset = 0,0
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = !time
time = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,0
volumescale = 100
channel = -1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -(vel y)*5

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
;---------------------------------------------------------------------------
; Air Z
[Statedef 440]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 440
sprpriority = 1

[State 0, VelMul]
type = VelMul
trigger1 = time <10
x = 1
y = .6

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = time = 10
physics = A

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
name = "Ki Blasts"
ID = 441
stateno = 441
pos = 35,-60
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = 1.25
size.yscale = 1.25

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
name = "Ki Blasts Effect"
ID = 1311
stateno = 1311
pos = 35,-60
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = .75
size.yscale = .75

[State 400, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Ki Blast Special
[Statedef 441]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7003
velset = 10,10
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,1
volumescale = 100
channel = -1

[State 0, AfterImage]
type = AfterImage
trigger1 = !time
time = -1
length = 10
framegap = 1
trans = add

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 75, 2
animtype = Medium
guardflag = MA
hitflag = MAFD
priority = 3, Hit
pausetime = 0, 8
sparkno = -1 + 0*(var(10):=8011)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=50), var(17):=0
hitsound = -1
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -6,10
air.velocity = -3,10
ground.hittime  = 11
air.hittime = 11
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
down.velocity = 0,0
getpower = 0,0
envshake.time = 8
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State -2, Sparks]
type=helper
trigger1= movehit=1 && numenemy
stateno=ifelse(moveguarded, var(15), var(10))
ID=9000
name="Spark"
postype=p1
pos= ifelse(p2dist x<0, (ceil(p2dist x)), ifelse(p2dist x<var(16), ceil(p2dist x), var(16))), var(17)
facing= ifelse((p2bodydist x >=-5),-1,1);-1;enemynear,facing
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1
size.xscale =1
size.yscale =1

[State 0, HitOverride]
type = HitOverride
trigger1 = !time
attr = SCA,NA,SA,HA,NP,SP,HP
stateno = 442
time = 999
ignorehitpause = 1

[State 0, DestroySelf]
type = ChangeState
trigger1 = movecontact
trigger2 = pos y > 5
trigger3 = frontedgebodydist < -60
value = 442
ignorehitpause = 1
;---------------------------------------------------------------------------
; Ki Blast Hit
[Statedef 442]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7001
velset = 0,0
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45
ignorehitpause = 1

[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = !time
time = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,0
volumescale = 100
channel = -1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime

;---------------------------------------------------------------------------
; Charge
[Statedef 900]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
sprpriority = 2

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = command = "holdx" && command = "holdy" && anim !=900
value = 900
persistent = 0

[State 0, PowerAdd]
type = PowerAdd
trigger1 = 1
value = 15

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 7010
ID = 7010
pos = 0,5
postype = p1
bindtime = -1
removetime = -1
pausemovetime = 0
supermovetime = 0
scale = .80,.65
sprpriority = 5
ownpal = 1
removeongethit = 1

[State 0, Explod]
type = Explod
trigger1 = time%15=0
anim = 8110
ID = 8110
pos = 0,-5
postype = p1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
removeongethit = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S500,0
volumescale = 100
channel = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S900,0
volumescale = 100
channel = 0

[State 0, PalFX]
type = PalFX
trigger1 = power = powermax
time = 2
add = 255,255,255

[State 0, StopSnd]
type = StopSnd
trigger1 = power = powermax
trigger2 = command != "holdx" || command != "holdy"
channel = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = power = powermax
trigger2 = command != "holdx" || command != "holdy"
id = 7010

[State 500, ChangeState]
type = ChangeState
trigger1 = power = powermax
trigger2 = command != "holdx" || command != "holdy"
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Final Flash
[Statedef 1000]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
anim = 1000
poweradd = ifelse(prevstateno = 370,-1000,-2000)
sprpriority = 1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 140
movetime = 140
pausebg = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S190,0
volumescale = 100
channel = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = S190,1
volumescale = 100
channel = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S1000,3
volumescale = 100
channel = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !time
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 240

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time > 10
flag = noFG
flag2 = noBG
flag3 = nobardisplay

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 8121
ID = 8260
pos = 0,0
postype = left
removetime = -2
bindtime = -1
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 0
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 8110
ID = 8260
pos = 0,0
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 19
anim = 8400
ID = 8260
pos = -45,-90
postype = p1
removetime = -2
bindtime = -1
pausemovetime = 999
supermovetime = 999
scale = 2,2
sprpriority = 1
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 7010
ID = 7010
pos = 0,0
postype = p1
bindtime = -1
removetime = 52
pausemovetime = 999
supermovetime = 999
scale = .80,.65
sprpriority = 5
ownpal = 1
removeongethit = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 2
anim = 182
ID = 8260
pos = -5,10
postype = p1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .75,.75
sprpriority = 5
ownpal = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 2
anim = 1001
ID = 1001
pos = 0,0
postype = p1
facing = 1
removetime = -2
bindtime = -1
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 6
ownpal = 1
persistent = 0

[State 0, EnvShake]
type = EnvShake
trigger1 = !time 
time = 10
freq = 60
ampl = -8
phase = 90

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 19
value = S1000,0
volumescale = 100
channel = -1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 19
value = S1000,3
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 23
value = S1000,2
volumescale = 100
channel = 0

[State 0, EnvShake]
type = EnvShake
trigger1 = animelemtime(7)>0 && time%6=0 && time < 210
time = 6
freq = 60
ampl = -6
phase = 90

[State 250, Hitdef]
type = HitDef
trigger1 = time%6=0 && time < 210
attr = S, HP
damage = 25, 1
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 0
sparkno = -1 + 0*(var(10):=8014)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-55
hitsound = s1, 3
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -5,-3
air.velocity = -1.4,-3
ground.hittime  = 30
air.hittime = 30
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
getpower = 0,0
envshake.time = 6
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 0, Explod]
type = Explod
trigger1 = uniqhitcount = 12
anim = 8210
ID = 8260
pos = 0,-50
postype = p2
facing = 1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 6
ownpal = 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = uniqhitcount = 12
value = S1000,5
volumescale = 100
channel = -1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 7
value = S1000,1
volumescale = 100
channel = -1

[State 0, Helper]
type = Helper
trigger1 = animelem = 7
name = "SuperBackground"
ID = 1010
stateno = 7600
pos = 0,-60
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = animelem = 2
name = "Final Charge"
ID = 1010
stateno = 1015
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = animelem = 2
name = "Final Charge2"
ID = 1010
stateno = 1016
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = animelem = 7
name = "Final Flash"
ID = 1010
stateno = 1010
pos = 23,-110
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Explod]
type = Explod
triggerall = facing=1
trigger1 = animelem = 23
anim = 8122
ID = 8260
pos = 0,0
postype = left
facing = 1
bindtime = -1
removetime = 100
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 6
ownpal = 1

[State 0, Explod]
type = Explod
triggerall = facing = -1
trigger1 = animelem = 23
anim = 8122
ID = 8260
pos = 0,0
postype = right
facing = -1
bindtime = -1
removetime = 100
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 6
ownpal = 1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 1
y = -.5

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 7
x = -.5
y = .5

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 8
x = 0
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 2
y = 0

[State 0, Gravity]
type = Gravity
trigger1 = time > 235

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time = 235
id = 7010

[State 400, ChangeState]
type = ChangeState
trigger1 = pos y > 15 && vel y > 0
value = 52
ctrl = 0
;---------------------------------------------------------------------------
; Final Flash
[Statedef 1010]
type    = A
movetype= A
physics = N
anim = 8130
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45
scale = 1,1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
;---------------------------------------------------------------------------
; Final Charge
[Statedef 1015]
type    = A
movetype= A
physics = N
anim = 8126
sprpriority = 6

[State 0, BindToParent]
type = BindToParent
trigger1 = !time
time = 22
facing = 0
pos = -60,-95
persistent = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = time = 22
time = 4
facing = 0
pos = -51,-100
persistent = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = time = 26
time = 4
facing = 0
pos = -4,-88
persistent = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = time = 30
time = 50
facing = 0
pos = 40,-125
persistent = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 10*time
scale = 0+time*.01,0+time*.01
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 90
;---------------------------------------------------------------------------
; Final Charge 2
[Statedef 1016]
type    = A
movetype= A
physics = N
anim = 8126
sprpriority = 6

[State 0, BindToParent]
type = BindToParent
trigger1 = !time
time = 22
facing = 0
pos = 20,-88
persistent = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = time = 22
time = 4
facing = 0
pos = 40,-90
persistent = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = time = 26
time = 4
facing = 0
pos = 31,-91
persistent = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 10*time
scale = 0+time*.01,0+time*.01
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 30
;---------------------------------------------------------------------------
; Big Bang Attack
[Statedef 1100]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 1100
poweradd = -500
sprpriority = 1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 58
movetime = 57
pausebg = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S1100,2
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = S1200,0
volumescale = 100
channel = -1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S1200,2
volumescale = 100
channel = -1

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 4 
x = -4

[State 0, Explod]
type = Explod
trigger1 = animelem = 4 
anim = 8100
ID = 8100
pos = -40,0
postype = p1
removetime = -2
scale = 1,1
sprpriority = 5
ownpal = 1
removeongethit = 1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 4 
anim = 7002
ID = 7002
pos = 66,-93
postype = p1
bindtime = -1
removetime = -2
scale = 2,2
sprpriority = 5
ownpal = 1
removeongethit = 1
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
name = "Big Bang Attack"
ID = 1110
stateno = 1110
postype = p1
pos = 75,-93
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = animelem = 3
name = "Final Charge"
ID = 1110
stateno = 1115
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, ChangeState]
type = ChangeState
trigger1 = !animtime
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Big Bang Attack
[Statedef 1110]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7021
velset = 10,0
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,1
volumescale = 100
channel = -1

[State 0, AfterImage]
type = AfterImage
trigger1 = !time
time = -1
length = 10
framegap = 1
trans = add
ignorehitpause = 1

[State 300, Hitdef]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 150, 10
animtype = Medium
guardflag = MA
hitflag = MAFD
priority = 3, Hit
pausetime = 0, 8
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=50), var(17):=0
hitsound = -1
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -7,-2
air.velocity = -7,-2
ground.hittime  = 11
air.hittime = 11
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
down.velocity = 0,0
getpower = 0,0
envshake.time = 8
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State -2, Sparks]
type=helper
trigger1= movehit=1 && numenemy
stateno=ifelse(moveguarded, var(15), var(10))
ID=9000
name="Spark"
postype=p1
pos= ifelse(p2dist x<0, (ceil(p2dist x)), ifelse(p2dist x<var(16), ceil(p2dist x), var(16))), var(17)
facing= ifelse((p2bodydist x >=-5),-1,1);-1;enemynear,facing
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1
size.xscale =1
size.yscale =1

[State 0, HitOverride]
type = HitOverride
trigger1 = !time
attr = SCA,NA,SA,HA,NP,SP,HP
stateno = 1011
time = 999
ignorehitpause = 1

[State 0, DestroySelf]
type = ChangeState
trigger1 = movecontact
trigger2 = pos y > 5
trigger3 = frontedgebodydist < -60
value = 1011
ignorehitpause = 1
;---------------------------------------------------------------------------
; Big Bang Hit
[Statedef 1011]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 7001
velset = 0,0
sprpriority = 5

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time>0
scale = 1.5,1.5
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AfterImageTime]
type = AfterImageTime
trigger1 = !time
time = 0
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S400,0
volumescale = 100
channel = -1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
;---------------------------------------------------------------------------
; Big Bang Charge
[Statedef 1115]
type    = A
movetype= A
physics = N
anim = 8125
sprpriority = 6

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 50
facing = 0
pos = 66,-93

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 10*time
scale = 0+time*.015,0+time*.015
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 50
;---------------------------------------------------------------------------
; Big Bang Ray
[Statedef 1200]
type    = A
movetype= A
physics = N
velset = 0,0
ctrl = 0
anim = 1200
poweradd = ifelse(prevstateno = 270 || prevstateno = 380,-1000,-2000)
sprpriority = 1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 83
movetime = 83
pausebg = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S1100,0
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 70
value = S1100,1
volumescale = 100
channel = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !time
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 195

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time > 10 && time < 130
flag = noFG
flag2 = noBG
flag3 = nobardisplay

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 8122
ID = 8260
pos = 0,0
postype = left
removetime = -2
bindtime = -1
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = 0
ownpal = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 2
name = "SuperBackground"
ID = 1100
stateno = 7610
pos = 0,-60
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 0, Helper]
type = Helper
trigger1 = animelem = 3
name = "Charge"
ID = 1205
stateno = 1205
pos = 49,-77
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999
size.xscale = 1
size.yscale = 1

[State 0, Helper]
type = Helper
trigger1 = animelemtime(4)>0 && time%10=0 && time < 125
name = "Big Bang Burst"
ID = 1311
stateno = 1311
pos = 58,-65
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = 1
size.yscale = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S1200,2
volumescale = 100
channel = -1

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
name = "Big Bang Ray"
ID = 1210
stateno = 1210
pos = 58,-60
postype = p1
ownpal = 1
supermovetime = 0
pausemovetime = 0
size.xscale = 1
size.yscale = 1

[State 250, Hitdef]
type = HitDef
trigger1 = time%6=0 && time < 210
attr = S, HP
damage = 25, 1
animtype = Heavy
guardflag = MA
hitflag = MAFD
priority = 3, Hit
pausetime = 0, 0
sparkno = -1 + 0*(var(10):=8014)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=0
hitsound = s1, 3
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -2,0
air.velocity = -2,0
down.velocity = 0,0
ground.hittime  = 30
air.hittime = 30
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
getpower = 0,0
envshake.time = 6
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 0, Explod]
type = Explod
trigger1 = uniqhitcount = 12
anim = 8210
ID = 8260
pos = 0,-50
postype = p2
facing = 1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 6
ownpal = 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = uniqhitcount = 12
value = S1000,5
volumescale = 100
channel = -1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 26
value = S1200,2
volumescale = 100
channel = -1

[State 0, Gravity]
type = Gravity
trigger1 = time > 130

[State 400, ChangeState]
type = ChangeState
trigger1 = pos y > 15 && vel y > 0
value = 52
ctrl = 0
;---------------------------------------------------------------------------
; Big Bang Ray Charge
[Statedef 1205]
type    = A
movetype= A
physics = N
anim = 8125
sprpriority = 6

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 50
facing = 0
pos = 68,-58

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 10*time
scale = 0+time*.01,0+time*.01
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 75

;---------------------------------------------------------------------------
; Big Bang Ray Attack
[Statedef 1210]
type    = A
movetype= A
physics = N
anim = 8120
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -130
scale = 1,1
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime
;---------------------------------------------------------------------------
; Ki Blast Special Effect
[Statedef 1311]
movetype= I
anim = 7002
sprpriority = 5

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime

;---------------------------------------------------------------------------
; Final Explosion Start Up
[Statedef 1400]
type    = A
movetype= A
physics = N
juggle  = 2
velset = 0,0
ctrl = 0
anim = 1400
poweradd = -3000
sprpriority = 2

[State 0, Pause]
type = Pause
trigger1 = !time
time = 20
movetime = 20

[State 0, Explod]
type = Explod
trigger1 = !time || animelem = 5
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 5
x = enemy,pos x + ifelse(facing=1,80,-80)
y = 30

[State 0, Turn]
type = Turn
trigger1 = animelem = 6

[State 250, Hitdef]
type = HitDef
trigger1 = animelem = 10
attr = A, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 16
sparkno = -1 + 0*(var(10):=8012)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=25), var(17):=-100
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -1,0-10
air.velocity = -1,-10
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
snap = 20, -30
fall = 1
fall.xvelocity = .1
fall.yvelocity = 0
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 14
value = S390,0
volumescale = 100
channel = 0

[State 250, Hitdef]
type = HitDef
trigger1 = animelem = 15
attr = A, NA
damage = 25, 2
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 20, 16
sparkno = -1 + 0*(var(10):=8013)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=45), var(17):=-70
hitsound = s1, 5
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -10,-1
air.velocity = -10,-1
ground.hittime  = 15
air.hittime = 15
airguard.velocity = -1.9,-.8
fall = 1
fall.xvelocity = .1
fall.yvelocity = 0
p2facing = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
down.velocity = 0,0
down.hittime = 30
;getpower = 0,0
envshake.time = 20
envshake.freq = 60
envshake.ampl = -4
envshake.phase = 90
p1stateno = 1405
p2stateno = 1420

[State 0, Explod]
type = Explod
trigger1 = animelem = 15 && movehit = 1
anim = 8300
ID = 8300
pos = 0,0
postype = left
bindtime = -1
removetime = 20
pausemovetime = 99
supermovetime = 99
scale = gamewidth/640,gameheight/480
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1
persistent = 1

[State 300, PlaySnd]
type = PlaySnd
trigger1 = !time
value = s350, 0
channel = -1
volumescale = 100

[State 300, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3 || animelem = 7
value = s0, 0
channel = -1
volumescale = 100

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 10
x = 1
y = -8

[State 0, VelMul]
type = VelMul
trigger1 = time > 36 && time < 46
y = .75

[State 0, Gravity]
type = Gravity
trigger1 = time > 60

[State 250, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0
value = 52
;---------------------------------------------------------------------------
; Explosion Hit
[Statedef 1405]
type    = A
movetype= A
physics = N
ctrl = 0
anim = 1405
velset = 0,0
sprpriority = 2

[State 0, Explod]
type = Explod
triggerall = anim = 1405
trigger1 = !time
anim = 8123
ID = 8123
pos = 160,120
postype = Left
removetime = -2
bindtime = -1
pausemovetime = 999
supermovetime = 999
scale = 1,1
sprpriority = -1
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, ScreenBound]
type = ScreenBound
trigger1 = anim = 1405
value = 0
movecamera = 0,0

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = nobardisplay

[State 0, AllPalFX]
type = AllPalFX
triggerall = anim = 1405
trigger1 = time = 20
time = 30
sinadd = -256,-256,-256,60

[State 0, Explod]
type = Explod
triggerall = anim = 1405
trigger1 = time = 35
anim = 7600
ID = 7600
pos = 160,120
postype = Left
removetime = 400
bindtime = -1
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 0
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 80
value = S1,6
volumescale = 100
channel = -1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time > 40 && time%7=0 && time < 80
value = S40,0
volumescale = 100
channel = -1

[State 0, PosSet]
type = PosSet
triggerall = facing = 1
trigger1 = time = 40
x = -100
y = 0

[State 0, PosSet]
type = PosSet
triggerall = facing = -1
trigger1 = time = 40
x = 100
y = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 180
value = S190,7
volumescale = 100
channel = -1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 180
value = S190,3
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 300
value = S1400,0
volumescale = 100
channel = -5

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 180
time = 200
freq = 60
ampl = 7
phase = 90

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 151
value = 1406

[State 0, Explod]
type = Explod
trigger1 = time%4=0 && time > 200 && time < 300
anim = 8006+random%4
ID = 8006
pos = 10,-20
postype = p1
random = 50,50
velocity = 0,0;-6+random%12,0
accel = 0,-.1
facing = 1
removetime = -2
pausemovetime = 0
supermovetime = 0
scale = 1,1
sprpriority = 5
ownpal = 1
removeongethit = 1
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = time = 151
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 300, PlaySnd]
type = PlaySnd
trigger1 = time = 151
value = s350, 0
channel = -1
volumescale = 100

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 300
value = 1410

[State 0, Helper]
type = Helper
trigger1 = time = 300
name = "Final Explosion"
ID = 1410
stateno = 1410
pos = 7,0
postype = p1
ownpal = 1
supermovetime = 999
pausemovetime = 999

[State 250, Hitdef]
type = HitDef
trigger1 = time%2=0
attr = S, HP
damage = 10, 1
animtype = Heavy
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 0
sparkno = -1 + 0*(var(10):=8014)
guard.sparkno =  s8010
sparkxy = 0 + 0*(var(16):=55), var(17):=-55
hitsound = s1, 3
guardsound = s2, 0
ground.type = Low
air.type = Low
ground.slidetime = 5
ground.velocity = -5,-3
air.velocity = -1.4,-3
ground.hittime  = 30
air.hittime = 30
airguard.velocity = -1.9,-.8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
getpower = 0,0
envshake.time = 6
envshake.freq = 60
envshake.ampl = -6
envshake.phase = 90

[State 0, LifeAdd]
type = LifeAdd
trigger1 = time = 599
value = -500
kill = 0
absolute = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = time = 600
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Explosion
[Statedef 1410]
movetype= I
anim = 8220
velset = 0,0
sprpriority = 5

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
scale = 0+time*0.15,0+time*0.15

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = !animtime

;---------------------------------------------------------------------------
; P2 Flying Off
[Statedef 1420]
movetype= H
physics = N
ctrl = 0
velset = 0,0
sprpriority = 1
;======================================
[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time 
value = 1420

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, VelSet]
type = VelSet
trigger1 = hitshakeover && facing
x = -20
persistent = 0

[State 0, VelSet]
type = VelSet
trigger1 = hitshakeover && !facing
x = 20
persistent = 0

;======================================
[State 0, PosSet]
type = PosSet
triggerall = facing = 1
trigger1 = time = 42
x = 300
y = -100

[State 0, PosSet]
type = PosSet
triggerall = facing = -1
trigger1 = time = 42
x = -300
y = -100

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time > 42
value = 10+time*45

[State 0, VelSet]
type = VelSet
triggerall = facing
trigger1 = time = 42
x = -6
y = -1

[State 0, VelSet]
type = VelSet
triggerall = !facing
trigger1 = time = 42
x = 6
y = -1

[State 0, Gravity]
type = Gravity
trigger1 = time >80

[State 0, ChangeState]
type = ChangeState
trigger1 = pos y > 0 && vel y > 0
value = 1421
ctrl = 0

;---------------------------------------------------------------------------
; P2 Hit Ground
[Statedef 1421]
type = A
movetype= H
physics = N
ctrl = 0
sprpriority = 1
;======================================
[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = !time 
value = 1421

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = -3
y = 0
persistent = 0

[State 0, VelMul]
type = VelMul
trigger1 = time > 0 && time < 100
x = .9

[State 0, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = anim = 1421 && !animtime
value = 5120

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = anim = 5120 && !animtime
value = 5300


;---------------------------------------------------------------------------
; FF SB
[Statedef 7600]
type    = A
movetype= A
physics = N
anim = 7600
sprpriority = 5

[State 0, BindToParent]
type = BindToParent
trigger1 = !time
time = 999
pos = 0,-60

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 45
scale = 1.5,1.5
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time >= 95
;---------------------------------------------------------------------------
; BBR SB
[Statedef 7610]
type    = A
movetype= A
physics = N
anim = 7600
sprpriority = 5

[State 0, BindToParent]
type = BindToParent
trigger1 = !time
time = 999
pos = 0,-60

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45
scale = 1.5,1.5
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time >= 120
;---------------------------------------------------------------------------
; ULTI SB
[Statedef 7620]
type    = A
movetype= A
physics = N
anim = 7600
sprpriority = 5

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = !time
time = 999
pos = 0,-60

[State 0, Trans]
type = Trans
trigger1 = 1
trans = add
ignorehitpause = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 0
scale = 2,2
ignorehitpause = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 505

;--- WEAK ---
[Statedef 8010]
type = A
physics = N
movetype = I
anim = 9999
velset = 0, 0
sprpriority = 5

[State 8010, Assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8001
ID = 3
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 3
scale = 0 +(0.1 * time), 0 +(0.1 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8000
ID = 4
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 4
scale = 0 +(0.06 * time), 0 +(0.06 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, End]
type = removeexplod
trigger1 = time >= 15
[State 8010, End]
type = destroyself
trigger1 = time >= 16

;--- MEDIUM ---
[Statedef 8011]
type = A
physics = N
movetype = I
anim = 9999
velset = 0, 0
sprpriority = 5

[State 8010, Assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8001
ID = 3
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 3
scale = 0 +(0.15 * time), 0 +(0.15 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8000
ID = 4
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 4
scale = 0 +(0.1 * time), 0 +(0.1 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, End]
type = removeexplod
trigger1 = time >= 15
[State 8010, End]
type = destroyself
trigger1 = time >= 16
;--- HEAVY ---
[Statedef 8012]
type = A
physics = N
movetype = I
anim = 9999
velset = 0, 0
sprpriority = 5

[State 8010, Assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8001
ID = 3
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 3
scale = 0 +(0.2 * time), 0 +(0.2 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8000
ID = 4
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 4
scale = 0 +(0.12 * time), 0 +(0.12 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, End]
type = removeexplod
trigger1 = time >= 15
[State 8010, End]
type = destroyself
trigger1 = time >= 16
;--- SPECIAL ---
[Statedef 8013]
type = A
physics = N
movetype = I
anim = 9999
velset = 0, 0
sprpriority = 5

[State 8010, Assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 8050
ID = 8050
scale = 0,0
pausemovetime = 999
supermovetime = 999
ownpal = 1
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = 1
ID = 8050
anim = 8050
postype = p1
pos = 0,0
pausemovetime = 999
supermovetime = 999
scale = 0+time*0.25,0+time*0.25
removetime = 30
sprpriority = 5
ontop = 0
ownpal = 1
ignorehitpause = 1
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8001
ID = 3
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 3
scale = 0 +(0.3 * time), 0 +(0.3 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8000
ID = 4
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 4
scale = 0 +(0.15 * time), 0 +(0.15 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, End]
type = removeexplod
trigger1 = time >= 15
[State 8010, End]
type = destroyself
trigger1 = time >= 16
;--- HELPER ---
[Statedef 8014]
type = A
physics = N
movetype = I
anim = 9999
velset = 0, 0
sprpriority = 5

[State 0, PosSet]
type = PosSet
trigger1 = 1
x = enemy,pos x 
y = enemy,pos y - 55

[State 8010, Assert]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8001
ID = 3
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 3
scale = 0 +(0.2 * time), 0 +(0.2 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, OutwardWave]
type = explod
trigger1 = !time
anim = 8000
ID = 4
postype = p1
facing = ifelse(random < 500, -1, 1)
vfacing = ifelse(random < 500, -1, 1)
sprpriority = 6
removetime = 8
pausemovetime = -1
supermovetime = -1
[State 8010, Scale]
type = modifyexplod
trigger1 = numexplod(4)
ID = 4
scale = 0 +(0.1 * time), 0 +(0.1 * time)
trans = addalpha
alpha = 256-(time*32), 256

[State 8010, End]
type = removeexplod
trigger1 = time >= 15
[State 8010, End]
type = destroyself
trigger1 = time >= 16
;---------------------------------------------------------------------------
; Wall Bounce
[Statedef 5400]
type    = A
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 0, ChangeAnim2]
type = ChangeAnim2
triggerall = anim != 5401
trigger1 = hitshakeover = 1 || !time
value = 5400
persistent = 0

[State 1026, Velocity]
type = VelSet
triggerall = anim = 5400
trigger1 = hitshakeover = 1
x = hitvel x
y = hitvel y

[State 1026, Gravity]
type = VelAdd
triggerall = anim = 5400
trigger1 = hitshakeover = 1
y = .45

[State 1026, No scroll]
type = ScreenBound
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist < 65
trigger2 = FrontEdgeBodyDist < 65
value = 1
movecamera = 0,1

[State 1026, Hit wall]
type = ChangeState
triggerall = anim = 5400
triggerall = Pos y < -15
trigger1 = BackEdgeBodyDist <= 10
trigger2 = FrontEdgeBodyDist <= 10
value = 5401

[State 1026, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;---------------------------------------------------------------------------
; Wall Bounce Hitwall
[Statedef 5401]
type    = A
movetype = H
physics = N
velset = 0,0
ctrl = 0

[State 5401, EnvShake]
type = EnvShake
trigger1 = !time 
time = 10
freq = 60
ampl = -8
phase = 90

[State 5401, Spark]
type = Explod
trigger1 = Time = 0
anim = F72
pos = 0, floor (screenpos y) - 50
postype = back
sprpriority = 3

[State 5401, Sound]
type = PlaySnd
trigger1 = Time = 0
value = F7,0

[State 5401, ChangeAnim2]
type = ChangeAnim
trigger1 = time = 10
value = 5061

[State 5401, Turn]
type = Turn
trigger1 = time = 10

[State 5401, VelSet]
type = VelSet
trigger1 = time = 10
x = -3
y = -3

[State 5401, Gravity]
type = Gravity
trigger1 = time >=10

[State 5401, Hit ground]
type = SelfState
trigger1 = Vel y > 0 && Pos y >= 0
value = 5100

;===================================================;
;               COPIED FROM COMMON1.CNS             ;
;===================================================;
;---------------------------------------------------------------------------
; GUARD (start)
[Statedef 120]
type = U   ;Leave state type unchanged
physics = U;Leave physics unchanged

[State 120]
Type=CtrlSet
Trigger1=var(59)>0
value=0

[State 120, 1]
type = ChangeAnim
trigger1 = Time = 0
value = 120 + (statetype = C) + (statetype = A)*2

[State 120, 2]
type = StateTypeSet
trigger1 = Time = 0 && statetype = S
physics = S

[State 120, 3]
type = StateTypeSet
trigger1 = Time = 0 && statetype = C
physics = C

[State 120, 4]
type = StateTypeSet
trigger1 = Time = 0 && statetype = A
physics = A

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(59)=0
trigger1 = command = "holddown"
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(59)=0
trigger1 = command!= "holddown"
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
statetype = S
physics = S

[State 120, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 130 + (statetype = C) + (statetype = A)*2

[State 120, Stop Guarding]
type = ChangeState
trigger1 = command!= "holdback"
trigger1 = var(59)=0
trigger2 =!inguarddist
value = 140

;---------------------------------------------------------------------------
; Stand guard (guarding)
[Statedef 130]
type    = S
physics = S

[State 120]
Type=CtrlSet
Trigger1=var(59)>0
value=0

[State 130, 1]
type = ChangeAnim
trigger1 = Anim!= 130
value = 130

[State 130, Hi to Lo]
type = ChangeState
trigger1 = command = "holddown"
trigger1 = var(59)=0
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
value = 131

[State 130, Stop Guarding]
type = ChangeState
trigger1 = var(59)=0
trigger1 = command!= "holdback"
trigger2 =!inguarddist
value = 140

;---------------------------------------------------------------------------
; Crouch guard (guarding)
[Statedef 131]
type    = C
physics = C

[State 120]
Type=CtrlSet
Trigger1=var(59)>0
value=0

[State 131, 1]
type = ChangeAnim
trigger1 = Anim!= 131
value = 131

[State 131, Lo to Hi]
type = ChangeState
trigger1 = command!= "holddown"
trigger1 = var(59)=0
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
value = 130

[State 131, Stop Guarding]
type = ChangeState
trigger1 = var(59)=0
trigger1 = command!= "holdback"
trigger2 =!inguarddist
value = 140

;---------------------------------------------------------------------------
; Air guard (guarding)
[Statedef 132]
type    = A
physics = N

[State 120]
Type=CtrlSet
Trigger1=var(59)>0
value=0

[State 132, 1]
type = ChangeAnim
trigger1 = Anim!= 132
value = 132

[State 132, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 132, 3]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 132, 4]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 132, 5]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 132, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback" || (var(59)>0)
trigger1 = inguarddist
value = 130

[State 132, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52

[State 132, Stop Guarding]
type = ChangeState
trigger1 = var(59)=0
trigger1 = command!= "holdback"
trigger2 =!inguarddist
value = 140


;---------------------------------------------------------------------------
; Stand guard hit (shaking)
[Statedef 150]
type    = S
movetype= H
physics = N
velset = 0,0

[State 150, 1]
type = ChangeAnim
trigger1 = 1
value = 150

[State 150, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(StateType=C)

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(59)=0
trigger1 = command = "holddown"
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(59)=0
trigger1 = command!= "holddown"
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
statetype = S
physics = S

[State 150, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 3

;---------------------------------------------------------------------------
; Stand guard hit (knocked back)
[Statedef 151]
type    = S
movetype= H
physics = S
anim = 150

[State 151, 1]
type = VelSet
trigger1 = Time = 0
x = HitVel x

[State 151, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
trigger1 = var(59)=0
value = 1

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(59)=0
trigger1 = command = "holddown"
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(59)=0
trigger1 = command!= "holddown"
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
statetype = S
physics = S

[State 151, 4]
type = ChangeState
trigger1 = HitOver
value = 130
ctrl =!var(59)

;---------------------------------------------------------------------------
; Crouch guard hit (shaking)
[Statedef 152]
type    = C
movetype= H
physics = N
velset = 0,0

[State 152, 1]
type = ChangeAnim
trigger1 = 1
value = 151

[State 152, 3]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2*(StateType=C)

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(59)=0
trigger1 = command = "holddown"
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(59)=0
trigger1 = command!= "holddown"
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
statetype = S
physics = S

[State 152, 4]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;---------------------------------------------------------------------------
; Crouch guard hit (knocked back)
[Statedef 153]
type    = C
movetype= H
physics = C
anim = 151

[State 153, 1]
type = VelSet
trigger1 = Time = 0
x = HitVel x

[State 153, 2]
type = VelSet
trigger1 = Time = GetHitVar(slidetime)
trigger2 = HitOver
x = 0

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
trigger1 = var(59)=0
value = 1

[State 120, Hi to Lo]
type = StateTypeSet
triggerall = statetype = S
trigger1 = var(59)=0
trigger1 = command = "holddown"
trigger2 = var(59)>0
trigger2 = (abs(P2Dist X)>120) || (P2MoveType=H) || (P2StateType=C)
trigger2 = P2StateType!=A
trigger2 = AILevel>=3
statetype = C
physics = C

[State 120, Lo to Hi]
type = StateTypeSet
triggerall = statetype = C
trigger1 = var(59)=0
trigger1 = command!= "holddown"
trigger2 = Var(59) > 0
trigger2 = p2statetype = A
trigger2 = abs(P2BodyDist X)=3
statetype = S
physics = S

[State 153, 4]
type = ChangeState
trigger1 = HitOver
value = 131
ctrl =!var(59)

;---------------------------------------------------------------------------
; Air guard hit (shaking)
[Statedef 154]
type    = A
movetype= H
physics = N
velset = 0,0

[State 154, 1]
type = ChangeAnim
trigger1 = 1
value = 152

[State 154, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 155;AGUARDHIT2

[State 154, 3]
type = ForceFeedback
trigger1 = time = 0
waveform = square
time = 4

;---------------------------------------------------------------------------
; Air guard hit (knocked away)
[Statedef 155]
type    = A
movetype= H
physics = N
anim = 152

[State 155, 1]
type = VelSet
trigger1 = Time = 0
x = HitVel x
y = HitVel y

[State 155, 2]
type = VelAdd
trigger1 = 1
y = Const(movement.yaccel)

[State 151, 3]
type = CtrlSet
trigger1 = Time = GetHitVar(ctrltime)
trigger1 = var(59)=0
value = 1

[State 155, 4]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0) && (vel y > 0)

[State 155, 5]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 155, 6]
type = ChangeState
trigger1 = sysvar(0)
trigger1 = command = "holdback" || var(59)>0
trigger1 = inguarddist
value = 130

[State 155, 7]
type = ChangeState
trigger1 = sysvar(0)
value = 52
;---------------------------------------------------------------------------
; Air get-hit (fall recovery on ground; still falling)
[Statedef 5200]
type    = A
movetype= A
physics = N
anim = 5201

[State 0, VelSet]
type = VelSet
trigger1 = !time
x = 0
y = 0

[State 5201, 3]
type = PosSet
trigger1 = !time
y = 0

[State 5201, 4]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S350,0
volumescale = 100
channel = 0

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 8040
ID = 8040
pos = -30,-40
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = 1,.25
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, Explod]
type = Explod
trigger1 = animelem = 6
anim = 8040
ID = 8040
pos = 0,-80
postype = p1
bindtime = -1
removetime = -2
pausemovetime = 999
supermovetime = 999
scale = .5,.5
sprpriority = 5
ownpal = 1
removeongethit = 0
ignorehitpause = 1

[State 0, Pause]
type = Pause
trigger1 = !time
time = 16
movetime = 13
ignorehitpause = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S5200,0
volumescale = 100
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !time
value = S350,0
volumescale = 100
channel = -1

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 5
x = enemy,pos x + ifelse(facing=1,80,-80)
y = enemy,pos y + -50

[State 0, Turn]
type = Turn
trigger1 = animelem = 6

[State 0, CtrlSet]
type = CtrlSet
trigger1 = animelem = 6
value = 1

[State 0, Gravity]
type = Gravity
trigger1 = animelemtime(8)>0

[State 0, ChangeState]
type = SelfState
trigger1 = pos y > 0 && vel y > 0
value = 52
ctrl = 0
;---------------------------------------------------------------------------
; Air get-hit (fall recovery in air)
[Statedef 5210]
type    = A
movetype= I
physics = N
anim = 5210
velset = 0,0
ctrl = 0

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 128,128,128

[State 0, Explod]
type = Explod
trigger1 = !time
anim = 8050
ID = 8050
scale = 0,0
ignorehitpause = 1

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = 1
ID = 8050
pos = 10,-80
postype = p1
pausemovetime = 999
supermovetime = 999
scale = 0+time*0.25,0+time*0.25
removetime = 30
sprpriority = 5
ontop = 0
ownpal = 1
ignorehitpause = 1
trans = addalpha
alpha = 256-(time*32), 256

[State 5210, 1]
type = PosFreeze
trigger1 = Time < 4

[State 5210, 2] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < Const720p(-80)

[State 5210, 3]
type = NotHitBy
trigger1 = Time = 0
value = SCA
time = 20

[State 5210, 4]
type = CtrlSet
trigger1 = Time = 18
value = 1

[State 5210, 5]
type = VelAdd
trigger1 = Time >= 18
y = Const(movement.air.gethit.airrecover.yaccel)

[State 5210, 5] ;Land on ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52 ;Jump land
ctrl = 1
;===================================================;
;              -2 STATES (ALWAYS ACTIVE)            ;
;===================================================;
[Statedef -2]

;#ADD004BASIC PIEs#
;//==========================
;// add004 supplementary sctrls v1.103
;//==========================

;// partner jump-out ; ???????
[state 0]
	type=selfstate
	triggerall=!ishelper && numpartner && roundstate=2
	triggerall=(stateno!=[190190,190199]) && alive && sysfvar(0)>0 && playeridexist(floor(sysfvar(0)))
	triggerall=playerid(floor(sysfvar(0))),var(0)=90900 && playerid(floor(sysfvar(0))),var(22)=4
	;;---// change ;(??)
	trigger1=sysfvar(4)<1 && movetype!=h && gethitvar(isbound)=0 && (pos y>=0) && (ctrl||(stateno<600&&time<2)) && (playerid(floor(sysfvar(0))),var(48)=11)
	;;---// as partner-asist ;(??)
	trigger2=sysfvar(4)>0 && (movetype!=h||(stateno=[120,149])) && (ctrl||stateno<600)
	;;---// player priority ;(??)
	trigger3=sysfvar(4)<1 && playerid(floor(sysfvar(0))),var(15)!=id
	value=190190
	ignorehitpause=1

;// edited life & power bar ; ?????
[state 0]
	type=helper
	triggerall=!ishelper && !numhelper(90900)
	trigger1=numpartner
	trigger1=id<(partner,id) && partner,numhelper(90900)=0
	trigger2=!numpartner
	id=90900
	stateno=90900
	helpertype=normal
	ownpal=1
	size.air.front=1602150 ;; <<-version
	size.height=0 ;; 1;; <<-powerbar off mode
	ignorehitpause=1
	supermovetime=88888
	pausemovetime=88888
	pos=0,88888

;// input players id ; ID??
[state 0]
	type=varset
	trigger1=!ishelper && numhelper(90900)
	trigger1=(helper(90900),var(0)=90900) && (sysfvar(0)!=helper(90900),id)
	sysfvar(0)=(helper(90900),id)
[state 0]
	type=varset
	trigger1=!ishelper && numpartner
	trigger1=!numhelper(90900) && (partner,numhelper(90900)) && (sysfvar(0)!=(partner,sysfvar(0)))
	sysfvar(0)=(partner,sysfvar(0))

;// bk/jd system ; ?????/????D
[state 0]
	type=hitoverride
	trigger1=(numprojid(195502)||numprojid(195503)) && !ishelper && roundstate=2 && alive && (ctrl || stateno=52)
	attr=sca,na,sa,ha,np,sp,hp
	stateno=195500
	time=1
	ignorehitpause=1

;//==========================
;;>>@Config.Face>>
;; face / portrait (?)
[state 0]
	type=explod
	trigger1=!ishelper && roundstate=2 && alive && !numexplod(490600) && selfanimexist(909002)
	trigger1=sysfvar(0)>id && playeridexist(floor(sysfvar(0)))
	trigger1=playerid(floor(sysfvar(0))),var(0)=90900 && playerid(floor(sysfvar(0))),numexplod(490600)
	id=490600
	anim=909002
	space=screen
	postype=left
	facing=ifelse(teamside=1,1,-1)
	scale=0,0 ;; <- default
	ownpal=1
	bindtime=-1
	removetime=-1
	ignorehitpause=1
	supermovetime=-1
	pausemovetime=-1

[state 0] ;; player is NOT in a custom state 
	type=modifyexplod
	trigger1=numexplod(490600) && sysfvar(0)>id && playeridexist(floor(sysfvar(0)))
	trigger1=playerid(floor(sysfvar(0))),var(0)=90900
	trigger1=movetype!=h || (stateno=[120,159]) || (stateno=[5000,5199]) || (stateno=[190190,190196])
	id=490600
	scale=playerid(floor(sysfvar(0))),fvar(32-(id=playerid(floor(sysfvar(0))),var(15))*10), playerid(floor(sysfvar(0))),fvar(33-(id=playerid(floor(sysfvar(0))),var(15))*10)
	ignorehitpause=1

[state 0]
	type=modifyexplod
	trigger1=numexplod(490600) && sysfvar(0)>id && playeridexist(floor(sysfvar(0)))
	trigger1=playerid(floor(sysfvar(0))),var(0)=90900
	id=490600
	space=screen
	postype=left
	pos=floor(const240p(playerid(floor(sysfvar(0))),fvar(30-(id=playerid(floor(sysfvar(0))),var(15))*10))), floor(const240p(playerid(floor(sysfvar(0))),fvar(31-(id=playerid(floor(sysfvar(0))),var(15))*10) -(roundstate!=2||(!alive&&stateno=5150))*88888))
;;(* if the player has been placed in a custom state, the result of "scale" is affected" by the different player's local coordinate space
	sprpriority=floor(playerid(floor(sysfvar(0))),fvar(36-(id=playerid(floor(sysfvar(0))),var(15))*10))
	trans=addalpha
	alpha=floor(playerid(floor(sysfvar(0))),fvar(34-(id=playerid(floor(sysfvar(0))),var(15))*10)), floor(playerid(floor(sysfvar(0))),fvar(35-(id=playerid(floor(sysfvar(0))),var(15))*10))
	ignorehitpause=1

;//==========================
;;>>@Config.Camera>>
;; change camera / ????
[state 0]
	type=screenbound
	trigger1=!ishelper && sysfvar(0)>id && playeridexist(floor(sysfvar(0)))
	trigger1=playerid(floor(sysfvar(0))),var(0)=90900 && numpartner && (sysfvar(4)>0 || stateno=5150)
	value=0
	movecamera=0,0
	ignorehitpause=1
[state 0]
	type=playerpush
	trigger1=!ishelper && sysfvar(0)>id && playeridexist(floor(sysfvar(0)))
	trigger1=playerid(floor(sysfvar(0))),var(0)=90900 && numpartner && (sysfvar(4)>0 || stateno=5150)
	value=0
	ignorehitpause=1
[state 0]
	type=screenbound
	trigger1=!ishelper && sysfvar(0)>id && playeridexist(floor(sysfvar(0)))
	trigger1=playerid(floor(sysfvar(0))),var(0)=90900 && (playerid(floor(sysfvar(0))),var(7)&65536) ;; system_switch
	value= ((numpartner && sysfvar(4)<1) || !numpartner) ;; [def=0]
	movecamera=0,0 ;; [x,y]
	ignorehitpause=1

;//==========================
;; optional settings
;//==========================
;;--- guard crush ; ????????
[state 0]
	type=palfx
	trigger1=(stateno=150 || stateno=152) && alive && !ishelper && (gametime%5=0) && sysfvar(0)>id && playeridexist(floor(sysfvar(0)))
	trigger1=(playerid(floor(sysfvar(0))),var(0)=90900) && (playerid(floor(sysfvar(0))),var(36)>=40)
	time=2
	add=200,0,0
[state 0]
	type=changestate
	trigger1=(stateno=150 || stateno=152) && alive && !ishelper && sysfvar(0)>id && playeridexist(floor(sysfvar(0)))
	trigger1=(playerid(floor(sysfvar(0))),var(0)=90900) && (playerid(floor(sysfvar(0))),var(36)>=50)
	value=190010
	ignorehitpause=1
;;--- dizzy
[state 0]
	type=changestate
	trigger1=stateno=5120 && (animtime=0) && !ishelper && numhelper(403000) ;;<-dizzy birds
	value=190116 ;;<- goto dizzy/stun state
;;--- fadeout when KOed ; KO????
[state 0]
	type=varset
	trigger1=stateno=5150 && time=1 && alive=0 && !ishelper && numpartner
	sysvar(1)=(roundstate<=2)
[state 0]
	type=assertspecial
	trigger1=stateno=5150 && alive=0 && !ishelper && numpartner && sysvar(1) && (((time=[80,150]) && time%10<5) || time>150)
	flag=invisible
	flag2=noshadow
[state 0]
	type=posset
	trigger1=stateno=5150 && time>=80 && alive=0 && !ishelper && numpartner && sysvar(1)
	y=(800-partner,pos y) *(((time=[80,150]) && time%10<5) || time>150)

;;--- pos reset debug (for mugen only) ---
[state 0]
	type=turn
	trigger1=roundstate=1 && time=1 && !ishelper && numpartner>1
	trigger1=sysfvar(0)>id && playeridexist(floor(sysfvar(0)))
	trigger1=playerid(floor(sysfvar(0))),var(0)=90900 && id>playerid(floor(sysfvar(0))),sysvar(0)+1
	trigger1=facing=ifelse(teamside=1,-1,1) && cond(teamside=1, screenpos x>playerid(id-2),screenpos x, screenpos x<playerid(id-2),screenpos x)
	persistent=0
[state 0]
	type=posset
	trigger1=roundstate=1 && time=1 && !ishelper && numpartner>1
	trigger1=sysfvar(0)>id && playeridexist(floor(sysfvar(0)))
	trigger1=playerid(floor(sysfvar(0))),var(0)=90900 && id>playerid(floor(sysfvar(0))),sysvar(0)+1
	trigger1=cond(teamside=1, screenpos x>playerid(id-2),screenpos x, screenpos x<playerid(id-2),screenpos x)
	x= playerid(id-1),pos x+const240p(20) *ifelse(teamside=1,-1,1)
	persistent=0
;//==========================
;//==========================

;============================ HITSPARKS ==================================
[State -2, Hit Detection]
type=varset
trigger1= movecontact!=1
var(30)=2
ignorehitpause=1

[State -2, Sparks]
type=helper
triggerall= movecontact=1 && var(30)=1
trigger1= movehit=1 && numenemy
trigger1= var(10)=8010 || var(10)=8011 || var(10)=8012 || var(10)=8013 || var(10)=8014
trigger2= moveguarded=1 && numenemy
trigger2= var(15)=9002 || var(15)=9003 || var(15)=9004 || var(15)=9005
stateno=ifelse(moveguarded, var(15), var(10))
ID=9000
name="Spark"
postype=p1
pos= ifelse(p2dist x<0, (ceil(p2dist x)), ifelse(p2dist x<var(16), ceil(p2dist x), var(16))), var(17)
facing= ifelse((p2bodydist x >=-5),-1,1);-1;enemynear,facing
ownpal=1
pausemovetime=65535
supermovetime=65535
ignorehitpause=1
size.xscale =1
size.yscale =1

[State -2, Hit Detection]
type=varrangeset
trigger1= movetype=I
trigger2= movetype=H && time
first=30
last=36
value=-1
ignorehitpause=1

[State -2, Hit Detection]
type=varadd
trigger1= var(30)>0
var(30)=-1
ignorehitpause=1
;--------------------------------------------------------------
[State -2, P2 Facing]
type=targetfacing
trigger1= movecontact=1 && numtarget
trigger1= !(target,hitshakeover) && !(target,hitfall) && (target,time<=1)
value= ifelse(p2dist x>=0, -1, 1)
ignorehitpause=1

[State -2, Damage based on hits]
type=varset
trigger1= numenemy
fvar(12)= enemynear,gethitvar(hitcount)
ignorehitpause=1

[State -2, Reset var when the opponent recovers]
type=varset
trigger1= numenemy
trigger1= (enemynear,movetype!=H)
trigger2= !numenemy
fvar(12)=1

[State -2, RemapPal]
type = RemapPal
trigger1 = command = "start" && command = "holddown"
trigger2 = command = "start" && command = "holdfwd"
trigger3 = command = "start" && command = "holdback"
source = 1,1
dest = 1,var(40)+1

[State -2, VarSet]
type = VarSet
trigger1 = command = "start" && command = "holddown"
trigger2 = command = "start" && command = "holdfwd"
trigger3 = command = "start" && command = "holdback"
v = 40
value = (var(40)+1) % 9

;===================================================;
;              -3 STATES (CALLED UPON)              ;
;===================================================;
[Statedef -3]

[State -3, Jump Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 40
value = 40, 0

[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52
value = 52, 0

[State -3, Hurt Sounds]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 5000 && random <500
value = 5000, 0+random%10
channel = 0
volumescale = 100
